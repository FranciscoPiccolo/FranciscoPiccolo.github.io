outlier.color = "grey")+
facet_grid(~warehouse_id, scales = "free_y")+
coord_flip()
q1 %>%
filter(product_family != "Unknown",
sort_type == "sortable",
snapshot_day >= Sys.Date()-30) %>%
group_by(snapshot_day,warehouse_id,gl_product_group_desc) %>%
summarise(cubic_feet = sum(cubic_feet),
quantity = sum(quantity)) %>%
mutate(acu = cubic_feet/quantity) %>%
ggplot2::ggplot()+
geom_boxplot(mapping = aes(x = gl_product_group_desc, y = acu),
outlier.shape = 20,
outlier.color = "grey")+
facet_grid(~warehouse_id, scales = "free_x")+
coord_flip()
q1 %>%
filter(product_family != "Unknown",
sort_type == "sortable",
snapshot_day >= Sys.Date()-30) %>%
group_by(snapshot_day,warehouse_id,gl_product_group_desc) %>%
summarise(cubic_feet = sum(cubic_feet),
quantity = sum(quantity)) %>%
mutate(acu = cubic_feet/quantity) %>%
ggplot2::ggplot()+
geom_boxplot(mapping = aes(x = reorder(gl_product_group_desc,acu, fun = median), y = acu),
outlier.shape = 20,
outlier.color = "grey")+
facet_grid(~warehouse_id, scales = "free_x")+
coord_flip()
q1 %>%
filter(product_family != "Unknown",
sort_type == "sortable",
snapshot_day >= Sys.Date()-30) %>%
group_by(snapshot_day,warehouse_id,gl_product_group_desc) %>%
summarise(cubic_feet = sum(cubic_feet),
quantity = sum(quantity)) %>%
mutate(acu = cubic_feet/quantity) %>%
ggplot2::ggplot()+
geom_boxplot(mapping = aes(x = reorder(gl_product_group_desc,acu, fun = median), y = acu),
outlier.shape = 20,
outlier.color = "grey")+
facet_grid(~warehouse_id)+
coord_flip()
q1 %>%
filter(product_family != "Unknown",
sort_type == "fullcase",
snapshot_day >= Sys.Date()-30) %>%
group_by(snapshot_day,warehouse_id,gl_product_group_desc) %>%
summarise(cubic_feet = sum(cubic_feet),
quantity = sum(quantity)) %>%
mutate(acu = cubic_feet/quantity) %>%
ggplot2::ggplot()+
geom_boxplot(mapping = aes(x = reorder(gl_product_group_desc,acu, fun = median), y = acu),
outlier.shape = 20,
outlier.color = "grey")+
facet_grid(~warehouse_id)+
coord_flip()
q1 <- readr::read_rds(paste(dataset_path,"query_1.RDS", sep = "/"))
q1$snapshot_day <- lubridate::ymd(q1$snapshot_day)
q1 %>%
group_by(snapshot_day,warehouse_id) %>%
summarise(cubic_feet = sum(cubic_feet),
quantity = sum(quantity)) %>%
mutate(acu = cubic_feet/quantity) %>%
ggplot2::ggplot()+
geom_line(mapping = aes(x = snapshot_day, y = acu),
size = 1)+
theme_graph()+
theme(legend.position = "none")+
facet_wrap(~warehouse_id, scales = "free_y")+
labs(title = "ACU per FC Over Time",
x = "Snapshot Day",
y = "ACU")
q1 %>%
head()
q1 %>%
filter(snapshot_day >= Sys.Date()-30) %>%
group_by(sort_type) %>%
summarise(cubic_feet = sum(cubic_feet),
quantity = sum(quantity)) %>%
mutate(acu = cubic_feet/quantity) %>%
head()
q1 %>%
filter(snapshot_day >= Sys.Date()-30,
sort_type != "Unknown") %>%
group_by(sort_type, snapshot_day, product_family) %>%
summarise(cubic_feet = sum(cubic_feet),
quantity = sum(quantity)) %>%
mutate(acu = cubic_feet/quantity) %>%
ggplot2::ggplot()+
geom_boxplot(mapping = aes(x = product_family, y = acu))+
facet_wrap(~product_family)
q1 %>%
filter(snapshot_day >= Sys.Date()-30,
sort_type != "Unknown") %>%
group_by(sort_type, snapshot_day, product_family) %>%
summarise(cubic_feet = sum(cubic_feet),
quantity = sum(quantity)) %>%
mutate(acu = cubic_feet/quantity) %>%
ggplot2::ggplot()+
geom_boxplot(mapping = aes(x = product_family, y = acu))+
facet_wrap(~sort_type)
q1 %>%
filter(snapshot_day >= Sys.Date()-30,
sort_type != "Unknown") %>%
group_by(sort_type, snapshot_day, product_family) %>%
summarise(cubic_feet = sum(cubic_feet),
quantity = sum(quantity)) %>%
mutate(acu = cubic_feet/quantity) %>%
ggplot2::ggplot()+
geom_boxplot(mapping = aes(x = product_family, y = acu))+
facet_wrap(~sort_type, scales = "free_y")
q1 %>%
filter(snapshot_day >= Sys.Date()-30,
sort_type != "Unknown") %>%
group_by(sort_type, snapshot_day, product_family) %>%
summarise(cubic_feet = sum(cubic_feet),
quantity = sum(quantity)) %>%
mutate(acu = cubic_feet/quantity) %>%
ggplot2::ggplot()+
geom_boxplot(mapping = aes(x = product_family, y = acu))+
facet_wrap(~sort_type, scales = "free_y")+
coord_flip()
q1 %>%
filter(snapshot_day >= Sys.Date()-30,
product_family != "Unknown",
sort_type != "Unknown") %>%
group_by(sort_type, snapshot_day, product_family) %>%
summarise(cubic_feet = sum(cubic_feet),
quantity = sum(quantity)) %>%
mutate(acu = cubic_feet/quantity) %>%
ggplot2::ggplot()+
geom_boxplot(mapping = aes(x = product_family, y = acu))+
facet_wrap(~sort_type, scales = "free_y")+
coord_flip()
q1 %>%
filter(snapshot_day >= Sys.Date()-30,
product_family != "Unknown",
sort_type != "Unknown") %>%
group_by(sort_type, snapshot_day, product_family) %>%
summarise(cubic_feet = sum(cubic_feet),
quantity = sum(quantity)) %>%
mutate(acu = cubic_feet/quantity) %>%
ggplot2::ggplot()+
geom_boxplot(mapping = aes(x = product_family, y = acu))+
facet_wrap(~sort_type, scales = "free_x")+
coord_flip()
q1 %>%
filter(snapshot_day >= Sys.Date()-30,
product_family != "Unknown",
sort_type != "unknown") %>%
group_by(sort_type, snapshot_day, product_family) %>%
summarise(cubic_feet = sum(cubic_feet),
quantity = sum(quantity)) %>%
mutate(acu = cubic_feet/quantity) %>%
ggplot2::ggplot()+
geom_boxplot(mapping = aes(x = product_family, y = acu))+
facet_wrap(~sort_type, scales = "free_x")+
coord_flip()
q1 %>%
filter(snapshot_day >= Sys.Date()-30,
product_family != "Unknown",
sort_type != "unknown") %>%
group_by(sort_type, snapshot_day, product_family) %>%
summarise(cubic_feet = sum(cubic_feet),
quantity = sum(quantity)) %>%
mutate(acu = cubic_feet/quantity) %>%
ggplot2::ggplot()+
geom_boxplot(mapping = aes(x = product_family, y = acu, fill = sort_type))+
facet_wrap(~sort_type, scales = "free_x")+
coord_flip()
q1 %>%
filter(snapshot_day >= Sys.Date()-30,
product_family != "Unknown",
sort_type != "unknown") %>%
group_by(sort_type, snapshot_day, product_family) %>%
summarise(cubic_feet = sum(cubic_feet),
quantity = sum(quantity)) %>%
mutate(acu = cubic_feet/quantity) %>%
ggplot2::ggplot()+
geom_boxplot(mapping = aes(x = product_family, y = acu, fill = sort_type))+
theme_graph()+
theme(legend.position = "none")+
scale_fill_brewer(type = "qual", palette = 2)+
facet_wrap(~sort_type, scales = "free_x")+
coord_flip()
q1 %>%
filter(snapshot_day >= Sys.Date()-30,
product_family != "Unknown",
sort_type != "unknown") %>%
group_by(sort_type, snapshot_day, product_family) %>%
summarise(cubic_feet = sum(cubic_feet),
quantity = sum(quantity)) %>%
mutate(acu = cubic_feet/quantity) %>%
ggplot2::ggplot()+
geom_boxplot(mapping = aes(x = product_family, y = acu, fill = sort_type))+
theme_graph()+
theme(legend.position = "none")+
scale_fill_brewer(type = "qual", palette = 2)+
facet_wrap(~sort_type, scales = "free_x")+
coord_flip()+
labs(title = "ACU per Sort Type and Product Family",
subtitle = "Distribution of the Last 30 days",
x = "",
y = "")
q1 %>%
filter(snapshot_day >= Sys.Date()-30,
product_family != "Unknown",
sort_type != "unknown") %>%
group_by(sort_type, snapshot_day, product_family) %>%
summarise(cubic_feet = sum(cubic_feet),
quantity = sum(quantity)) %>%
mutate(acu = cubic_feet/quantity) %>%
ggplot2::ggplot()+
geom_boxplot(mapping = aes(x = product_family, y = acu, fill = sort_type))+
theme_graph()+
theme(legend.position = "none")+
scale_fill_brewer(type = "qual", palette = 2)+
facet_grid(~sort_type, scales = "free_x")+
coord_flip()+
labs(title = "ACU per Sort Type and Product Family",
subtitle = "Distribution of the Last 30 days",
x = "",
y = "")
q1 %>%
filter(snapshot_day >= Sys.Date()-30,
product_family != "Unknown",
sort_type != "unknown") %>%
group_by(sort_type, snapshot_day, product_family) %>%
summarise(cubic_feet = sum(cubic_feet),
quantity = sum(quantity)) %>%
mutate(acu = cubic_feet/quantity) %>%
ggplot2::ggplot()+
geom_boxplot(mapping = aes(x = reorder(product_family, acu, .fun = median), y = acu, fill = sort_type))+
theme_graph()+
theme(legend.position = "none")+
scale_fill_brewer(type = "qual", palette = 2)+
facet_grid(~sort_type, scales = "free_x")+
coord_flip()+
labs(title = "ACU per Sort Type and Product Family",
subtitle = "Distribution of the Last 30 days",
x = "",
y = "")
q1 %>%
filter(snapshot_day >= Sys.Date()-30,
product_family != "Unknown",
sort_type != "unknown") %>%
group_by(sort_type, snapshot_day, product_family) %>%
summarise(cubic_feet = sum(cubic_feet),
quantity = sum(quantity)) %>%
mutate(acu = cubic_feet/quantity) %>%
ggplot2::ggplot()+
geom_boxplot(mapping = aes(x = reorder(product_family, acu, .fun = average), y = acu, fill = sort_type))+
theme_graph()+
theme(legend.position = "none")+
scale_fill_brewer(type = "qual", palette = 2)+
facet_grid(~sort_type, scales = "free_x")+
coord_flip()+
labs(title = "ACU per Sort Type and Product Family",
subtitle = "Distribution of the Last 30 days",
x = "",
y = "")
q1 %>%
filter(snapshot_day >= Sys.Date()-30,
product_family != "Unknown",
sort_type != "unknown") %>%
group_by(sort_type, snapshot_day, product_family) %>%
summarise(cubic_feet = sum(cubic_feet),
quantity = sum(quantity)) %>%
mutate(acu = cubic_feet/quantity) %>%
ggplot2::ggplot()+
geom_boxplot(mapping = aes(x = reorder(product_family, acu, .fun = average), y = acu, fill = sort_type))+
theme_graph()+
theme(legend.position = "none")+
scale_fill_brewer(type = "qual", palette = 2)+
facet_grid(~sort_type)+
coord_flip()+
labs(title = "ACU per Sort Type and Product Family",
subtitle = "Distribution of the Last 30 days",
x = "",
y = "")
q1 %>%
filter(snapshot_day >= Sys.Date()-30,
product_family != "Unknown",
sort_type != "unknown") %>%
group_by(sort_type, snapshot_day, product_family) %>%
summarise(cubic_feet = sum(cubic_feet),
quantity = sum(quantity)) %>%
mutate(acu = cubic_feet/quantity) %>%
ggplot2::ggplot()+
geom_boxplot(mapping = aes(x = reorder(product_family, acu, .fun = average), y = acu, fill = sort_type))+
theme_graph()+
theme(legend.position = "none")+
scale_fill_brewer(type = "qual", palette = 2)+
facet_grid(~sort_type, scales = "free_x")+
coord_flip()+
labs(title = "ACU per Sort Type and Product Family",
subtitle = "Distribution of the Last 30 days",
x = "",
y = "")
q1 %>%
filter(snapshot_day >= Sys.Date()-30,
product_family != "Consumables",
sort_type != "unknown") %>%
group_by(sort_type, snapshot_day, gl_product_group_desc) %>%
summarise(cubic_feet = sum(cubic_feet),
quantity = sum(quantity)) %>%
mutate(acu = cubic_feet/quantity) %>%
ggplot2::ggplot()+
geom_boxplot(mapping = aes(x = reorder(gl_product_group_desc, acu, .fun = average), y = acu, fill = sort_type))+
theme_graph()+
theme(legend.position = "none")+
scale_fill_brewer(type = "qual", palette = 2)+
facet_grid(~sort_type, scales = "free_x")+
coord_flip()+
labs(title = "ACU per Sort Type and Product Family",
subtitle = "Distribution of the Last 30 days",
x = "",
y = "")
library(tidyverse)
library(patchwork)
# Função para padronizar o design dos gráficos
theme_graph <- function(){
theme(
plot.title = element_text(size = 16),
plot.subtitle = element_text(size = 12),
plot.caption = element_text(face = "italic", size = 9),
axis.text = element_text(size = 9),
axis.title = element_text(face = "italic", size = 9),
strip.background = element_rect(fill = "grey"),
strip.text = element_text(face = "bold"),
legend.position = "bottom",
legend.title = element_blank()
)
}
dataset <- readr::read_csv(file = "https://raw.githubusercontent.com/FranciscoPiccolo/franciscopiccolo.github.io/master/datasets/2020-06-20-grocery_price_volatility/dataset_1.csv")
dataset$price <- as.numeric(dataset$price)
dataset %>%
group_by() %>%
summarise(first_date = min(date),
last_date = max(date)) %>%
tibble::tibble()
dataset %>%
group_by(local,product) %>%
summarise(count = n()) %>%
ggplot2::ggplot()+
geom_col(mapping = aes(x = product, y = count, fill = local))+
scale_fill_brewer(type = "qual", palette = )+
theme_graph()+
theme(legend.position = "none")+
coord_flip()+
facet_grid(~local)
dataset %>%
group_by(local,product) %>%
summarise(count = n()) %>%
ggplot2::ggplot()+
geom_col(mapping = aes(x = product, y = count, fill = local))+
scale_fill_brewer(type = "qual", palette = 3)+
theme_graph()+
theme(legend.position = "none")+
coord_flip()+
facet_grid(~local)
dataset %>%
group_by(product) %>%
summarise(rows = n()) %>%
filter(rows <= 4) %>%
select(product) -> low_sample_product
dataset <-
dataset %>%
mutate(price_per_vol = price/volume_gm_ml) %>%
filter(!product %in% c(low_sample_product$product))
dataset %>%
group_by(local,product) %>%
summarise(count = n()) %>%
ggplot2::ggplot()+
geom_col(mapping = aes(x = product, y = count, fill = local))+
scale_fill_brewer(type = "qual", palette = 3)+
theme_graph()+
theme(legend.position = "none")+
coord_flip()+
facet_grid(~local)
dataset %>%
group_by(local,product) %>%
summarise(count = n()) %>%
ggplot2::ggplot()+
geom_col(mapping = aes(x = product, y = count, fill = local))+
scale_fill_brewer(type = "qual", palette = 4)+
theme_graph()+
theme(legend.position = "none")+
coord_flip()+
facet_grid(~local)
dataset %>%
group_by(local,product) %>%
summarise(count = n()) %>%
ggplot2::ggplot()+
geom_col(mapping = aes(x = product, y = count, fill = local))+
scale_fill_brewer(type = "qual", palette = 5)+
theme_graph()+
theme(legend.position = "none")+
coord_flip()+
facet_grid(~local)
dataset %>%
group_by(local,product) %>%
summarise(count = n()) %>%
ggplot2::ggplot()+
geom_col(mapping = aes(x = product, y = count, fill = local))+
scale_fill_brewer(type = "qual", palette = 6)+
theme_graph()+
theme(legend.position = "none")+
coord_flip()+
facet_grid(~local)
dataset %>%
group_by(local,product) %>%
summarise(count = n()) %>%
ggplot2::ggplot()+
geom_col(mapping = aes(x = product, y = count, fill = local))+
scale_fill_brewer(type = "qual", palette = 8)+
theme_graph()+
theme(legend.position = "none")+
coord_flip()+
facet_grid(~local)
dataset %>%
group_by(local,product) %>%
summarise(count = n()) %>%
ggplot2::ggplot()+
geom_col(mapping = aes(x = product, y = count, fill = local))+
scale_fill_brewer(type = "qual", palette = 98)+
theme_graph()+
theme(legend.position = "none")+
coord_flip()+
facet_grid(~local)
dataset %>%
group_by(local,product) %>%
summarise(count = n()) %>%
ggplot2::ggplot()+
geom_col(mapping = aes(x = product, y = count, fill = local))+
scale_fill_brewer(type = "qual", palette = 9)+
theme_graph()+
theme(legend.position = "none")+
coord_flip()+
facet_grid(~local)
dataset %>%
group_by(local,product) %>%
summarise(count = n()) %>%
ggplot2::ggplot()+
geom_col(mapping = aes(x = product, y = count, fill = local))+
scale_fill_brewer(type = "qual", palette = 2)+
theme_graph()+
theme(legend.position = "none")+
coord_flip()+
facet_grid(~local)
dataset %>%
ggplot2::ggplot()+
geom_boxplot(mapping = aes(x = reorder(product,price_per_vol, .fun = mean), y = price_per_vol),
fill = "steel blue",
outlier.shape = 20,
outlier.color = "grey")+
coord_flip()+
theme_graph()
dataset %>%
ggplot2::ggplot()+
geom_boxplot(mapping = aes(x = reorder(product,price_per_vol, .fun = mean), y = price_per_vol),
fill = "steel blue",
outlier.shape = 20,
outlier.color = "grey")+
coord_flip()+
facet_grid(~local)+
theme_graph()
dataset %>%
ggplot2::ggplot()+
geom_boxplot(mapping = aes(x = reorder(product,price_per_vol, .fun = mean), y = price_per_vol, fill = local),
outlier.shape = 20,
outlier.color = "grey")+
scale_fill_brewer(type = "qual", palette = 2)+
coord_flip()+
facet_grid(~local)+
theme_graph()
dataset %>%
ggplot2::ggplot()+
geom_boxplot(mapping = aes(x = reorder(product,price_per_vol, .fun = mean), y = price_per_vol, fill = local),
outlier.shape = 20,
outlier.color = "grey")+
scale_fill_brewer(type = "qual", palette = 2)+
coord_flip()+
facet_grid(~local)+
theme_graph()+
theme(legend.position = "none")
dataset %>%
ggplot2::ggplot()+
geom_line(mapping = aes(x = date, y = price_per_vol, group = local, color = local),
size = 1)+
scale_color_brewer(type = "qual", palette = 6)+
theme_graph()+
facet_wrap(~product)
dataset %>%
ggplot2::ggplot()+
geom_line(mapping = aes(x = date, y = price_per_vol, group = local, color = local),
size = 1)+
scale_color_brewer(type = "qual", palette = 2)+
theme_graph()+
facet_wrap(~product)
setwd("C:/Users/fppicco/Desktop/R/Github/franciscopiccolo.github.io")
blogdown::serve_site()
blogdown::stop_server()
blogdown::serve_site()
blogdown::stop_server()
blogdown::serve_site()
blogdown::stop_server()
blogdown::serve_site()
blogdown::stop_server()
