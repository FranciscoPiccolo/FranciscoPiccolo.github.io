summarise(net_immigration = sum(value)) %>%
arrange(net_immigration) %>%
head(20) %>%
mutate(net_immigration = net_immigration * -1,
country = fct_reorder(country, net_immigration)) %>%
ggplot()+
geom_col(mapping = aes(x = country, y = net_immigration),
fill = "dark orange",
alpha = .6)+
scale_y_continuous(labels = scales::comma)+
theme_graph()+
coord_flip()+
labs(title = "Countries that had lost more residents since 2010",
x = "",
y = "Net immigration")
net_immigration %>%
group_by(country) %>%
summarise(net_immigration = sum(value)) %>%
arrange(net_immigration) %>%
head(20) %>%
mutate(net_immigration = net_immigration * -1,
country = fct_reorder(country, net_immigration)) %>%
ggplot()+
geom_col(mapping = aes(x = country, y = net_immigration),
fill = "steel blue")+
scale_y_continuous(labels = scales::comma)+
theme_graph()+
coord_flip()+
labs(title = "Countries that had lost more residents since 2010",
x = "",
y = "Net immigration")
blogdown::serve_site()
# Net immigration summed during the period
net_immigration %>%
group_by(country) %>%
summarise(net_immigration = sum(value)) -> net_immigration
# Joinning the population and net_immigration data
population %>%
filter(date == 2015) %>%
mutate(population = value) %>%
select(country, population) %>%
inner_join(net_immigration, by = c("country" = "country")) %>%
mutate(net_immigration_share = round(net_immigration/population, digits = 4)) %>%
arrange(net_immigration_share) %>%
head(20) %>%
mutate(net_immigration_share = net_immigration_share * -1,
country = fct_reorder(country, net_immigration_share)) %>%
ggplot()+
geom_col(mapping = aes(x = country, y = net_immigration_share),
fill = "dark orange",
alpha = .6)+
scale_y_continuous(labels = scales::percent)+
theme_graph()+
coord_flip()+
labs(title = "Share of population that left the country in the period",
x = "",
y = "",
caption = "From 2010 to 2017")
# Joinning the population and net_immigration data
population %>%
filter(date == 2015) %>%
mutate(population = value) %>%
select(country, population) %>%
inner_join(net_immigration, by = c("country" = "country")) %>%
mutate(net_immigration_share = round(net_immigration/population, digits = 4)) %>%
arrange(net_immigration_share) %>%
head(20) %>%
mutate(net_immigration_share = net_immigration_share * -1,
country = fct_reorder(country, net_immigration_share)) %>%
ggplot()+
geom_col(mapping = aes(x = country, y = net_immigration_share),
fill = "dark red")+
scale_y_continuous(labels = scales::percent)+
theme_graph()+
coord_flip()+
labs(title = "Share of population that left the country in the period",
x = "",
y = "",
caption = "From 2010 to 2017")
# Joinning the population and net_immigration data
population %>%
filter(date == 2015) %>%
mutate(population = value) %>%
select(country, population) %>%
inner_join(net_immigration, by = c("country" = "country")) %>%
mutate(net_immigration_share = round(net_immigration/population, digits = 4)) %>%
arrange(net_immigration_share) %>%
head(20) %>%
mutate(net_immigration_share = net_immigration_share * -1,
country = fct_reorder(country, net_immigration_share)) %>%
ggplot()+
geom_col(mapping = aes(x = country, y = net_immigration_share),
fill = "red")+
scale_y_continuous(labels = scales::percent)+
theme_graph()+
coord_flip()+
labs(title = "Share of population that left the country in the period",
x = "",
y = "",
caption = "From 2010 to 2017")
# Joinning the population and net_immigration data
population %>%
filter(date == 2015) %>%
mutate(population = value) %>%
select(country, population) %>%
inner_join(net_immigration, by = c("country" = "country")) %>%
mutate(net_immigration_share = round(net_immigration/population, digits = 4)) %>%
arrange(net_immigration_share) %>%
head(20) %>%
mutate(net_immigration_share = net_immigration_share * -1,
country = fct_reorder(country, net_immigration_share)) %>%
ggplot()+
geom_col(mapping = aes(x = country, y = net_immigration_share),
fill = "blue")+
scale_y_continuous(labels = scales::percent)+
theme_graph()+
coord_flip()+
labs(title = "Share of population that left the country in the period",
x = "",
y = "",
caption = "From 2010 to 2017")
# Joinning the population and net_immigration data
population %>%
filter(date == 2015) %>%
mutate(population = value) %>%
select(country, population) %>%
inner_join(net_immigration, by = c("country" = "country")) %>%
mutate(net_immigration_share = round(net_immigration/population, digits = 4)) %>%
arrange(net_immigration_share) %>%
head(20) %>%
mutate(net_immigration_share = net_immigration_share * -1,
country = fct_reorder(country, net_immigration_share)) %>%
ggplot()+
geom_col(mapping = aes(x = country, y = net_immigration_share),
fill = "dark blue")+
scale_y_continuous(labels = scales::percent)+
theme_graph()+
coord_flip()+
labs(title = "Share of population that left the country in the period",
x = "",
y = "",
caption = "From 2010 to 2017")
# Joinning the population and net_immigration data
population %>%
filter(date == 2015) %>%
mutate(population = value) %>%
select(country, population) %>%
inner_join(net_immigration, by = c("country" = "country")) %>%
mutate(net_immigration_share = round(net_immigration/population, digits = 4)) %>%
arrange(net_immigration_share) %>%
head(20) %>%
mutate(net_immigration_share = net_immigration_share * -1,
country = fct_reorder(country, net_immigration_share)) %>%
ggplot()+
geom_col(mapping = aes(x = country, y = net_immigration_share),
fill = "steel orange")+
scale_y_continuous(labels = scales::percent)+
theme_graph()+
coord_flip()+
labs(title = "Share of population that left the country in the period",
x = "",
y = "",
caption = "From 2010 to 2017")
# Joinning the population and net_immigration data
population %>%
filter(date == 2015) %>%
mutate(population = value) %>%
select(country, population) %>%
inner_join(net_immigration, by = c("country" = "country")) %>%
mutate(net_immigration_share = round(net_immigration/population, digits = 4)) %>%
arrange(net_immigration_share) %>%
head(20) %>%
mutate(net_immigration_share = net_immigration_share * -1,
country = fct_reorder(country, net_immigration_share)) %>%
ggplot()+
geom_col(mapping = aes(x = country, y = net_immigration_share),
fill = "steel blue")+
scale_y_continuous(labels = scales::percent)+
theme_graph()+
coord_flip()+
labs(title = "Share of population that left the country in the period",
x = "",
y = "",
caption = "From 2010 to 2017")
remitances_over_gdp <- wbstats::wb(indicator = "BX.TRF.PWKR.DT.GD.ZS",
country = "countries_only")
remitances_over_gdp %>%
filter(date == "2018",
country != "Lesotho",
value > 10) %>%
mutate(remitance_over_gdp = paste(round(value,digits = 0),"%",sep = "")) %>%
arrange(desc(value)) %>%
select(date, country, remitance_over_gdp)
blogdown::serve_site()
remitances_over_gdp %>%
filter(date == "2018",
country != "Lesotho",
value > 10) %>%
mutate("Remitance over gdp" = paste(round(value,digits = 0),"%",sep = ""),
rows = row_number()) %>%
arrange(desc(value)) %>%
select(rows, date, country, remitance_over_gdp) %>%
knitr::kable(format.args = list(decimal.mark = ",", big.mark = "."))
remitances_over_gdp %>%
filter(date == "2018",
country != "Lesotho",
value > 10) %>%
mutate("Remitance over gdp" = paste(round(value,digits = 0),"%",sep = ""),
rows = row_number()) %>%
arrange(desc(value)) %>%
select(rows, date, country, "Remitance over gdp") %>%
knitr::kable(format.args = list(decimal.mark = ",", big.mark = "."))
remitances_over_gdp %>%
filter(date == "2018",
country != "Lesotho",
value > 10) %>%
mutate("Remitance over gdp" = paste(round(value,digits = 0),"%",sep = "")) %>%
arrange(desc(value)) %>%
mutate(rows = row_number()) %>%
select(rows, date, country, "Remitance over gdp") %>%
knitr::kable(format.args = list(decimal.mark = ",", big.mark = "."))
blogdown::serve_site()
remitances_over_gdp %>%
filter(date == "2018",
country != "Lesotho",
value > 10) %>%
mutate("Remittance over gdp" = paste(round(value,digits = 0),"%",sep = "")) %>%
arrange(desc(value)) %>%
mutate(rows = row_number()) %>%
select(rows, date, country, "Remitance over gdp") %>%
knitr::kable(format.args = list(decimal.mark = ",", big.mark = "."))
remitances_over_gdp %>%
filter(date == "2018",
country != "Lesotho",
value > 10) %>%
mutate("Remittance over gdp" = paste(round(value,digits = 2),"%",sep = "")) %>%
arrange(desc(value)) %>%
mutate(rows = row_number()) %>%
select(rows, date, country, "Remittance over gdp") %>%
knitr::kable(format.args = list(decimal.mark = ",", big.mark = "."))
# Creating a variable with the selected countries
country_view <- c("Yemen, Rep.","Tanzania","Uganda",
"Tunisia","Chad","Syrian Arab Republic",
"	Suriname","Somalia","Sierra Leone",
"Senegal","Sudan","Rwanda","Nepal",
"Nigeria","Malawi","Mali","Libya",
"Kenya","Ethiopia","Eritrea",
"Congo, Rep.")
country_view
remitances_received <- wbstats::wb(indicator = "BX.TRF.PWKR.CD.DT",
country = "countries_only")
gdp_pc <- wbstats::wb(indicator = "NY.GDP.PCAP.CD",
country = "countries_only")
remitances_received
gdp_pc
remitances_received %>%
mutate(remitances = value) %>%
select(date, country, remitances) %>%
filter(country %in% country_view,
date > 2010) %>%
inner_join(population, by = c("date" = "date", "country" = "country")) %>%
select(date, country, remitances, value) %>%
mutate(remitances_adj = round(remitances/value, digits = 4)) %>%
select(date, country, remitances_adj) -> remitances
# Sample from dataset
remitances[sample(nrow(remitances),5), ] %>%
knitr::kable()
# Sample from dataset
remitances[sample(nrow(remitances),5), ] %>%
knitr::kable(caption = "Amostra do dataset")
gdp_pc %>%
mutate(gdp_pc = value) %>%
select(date, country, gdp_pc) %>%
inner_join(remitances, by = c("date" = "date", "country" = "country")) %>%
ggplot()+
geom_point(mapping = aes(x = remitances_adj, y = gdp_pc))+
geom_smooth(mapping = aes(x = remitances_adj, y = gdp_pc),
method = "lm",
formula = y ~ x,
se = F,
lty = 2,
color = "dark orange")+
theme_graph()+
labs(title = "Per Capita GDP and Remitances correlation",
y = "Per Capita GDP",
x = "Per Capita Remitances")
gdp_pc %>%
mutate(gdp_pc = value) %>%
select(date, country, gdp_pc) %>%
inner_join(remitances, by = c("date" = "date", "country" = "country")) %>%
ggplot()+
geom_point(mapping = aes(x = remitances_adj, y = gdp_pc))+
geom_smooth(mapping = aes(x = remitances_adj, y = gdp_pc),
method = "lm",
formula = y ~ x,
se = F,
lty = 2,
color = "dark orange")+
scale_y_continuous(labels = scales::comma)+
scale_x_continuous(labels = scales::comma)+
theme_graph()+
labs(title = "Per Capita GDP and Remitances correlation",
y = "Per Capita GDP",
x = "Per Capita Remitances")
gdp_pc %>%
mutate(gdp_pc = value) %>%
select(date, country, gdp_pc) %>%
inner_join(remitances, by = c("date" = "date", "country" = "country")) %>%
group_by(date) %>%
summarise(gdp = sum(gdp_pc),
remitance = sum(remitances_adj)) %>%
ggplot()+
geom_line(mapping = aes(x = date, y = gdp, group = 1),
color = "dark orange")+
scale_y_continuous(labels = scales::comma)+
theme_graph()+
labs(title = "Per Capita GDP time series")
gdp_pc %>%
mutate(gdp_pc = value) %>%
select(date, country, gdp_pc) %>%
inner_join(remitances, by = c("date" = "date", "country" = "country")) %>%
group_by(date) %>%
summarise(gdp = sum(gdp_pc),
remitance = sum(remitances_adj)) %>%
ggplot()+
geom_line(mapping = aes(x = date, y = remitance, group = 1),
color = "dark orange")+
scale_y_continuous(labels = scales::comma)+
theme_graph()+
labs(title = "Per Capita Remitances time series")
gdp_pc %>%
mutate(gdp_pc = value) %>%
select(date, country, gdp_pc) %>%
inner_join(remitances, by = c("date" = "date", "country" = "country")) %>%
group_by(date) %>%
summarise(gdp = sum(gdp_pc),
remitance = sum(remitances_adj)) %>%
ggplot()+
geom_line(mapping = aes(x = date, y = gdp),
color = "dark orange")+
geom_line(mapping = aes(x = date, y = remitances_adj))+
scale_y_continuous(labels = scales::comma)+
theme_graph()+
labs(title = "Per Capita GDP time series")
gdp_pc %>%
mutate(gdp_pc = value) %>%
select(date, country, gdp_pc) %>%
inner_join(remitances, by = c("date" = "date", "country" = "country")) %>%
group_by(date) %>%
summarise(gdp = sum(gdp_pc),
remitance = sum(remitances_adj)) %>%
ggplot()+
geom_line(mapping = aes(x = date, y = gdp),
color = "dark orange")+
geom_line(mapping = aes(x = date, y = remitance))+
scale_y_continuous(labels = scales::comma)+
theme_graph()+
labs(title = "Per Capita GDP time series")
gdp_pc %>%
mutate(gdp_pc = value) %>%
select(date, country, gdp_pc) %>%
inner_join(remitances, by = c("date" = "date", "country" = "country")) %>%
group_by(date) %>%
summarise(gdp = sum(gdp_pc),
remitance = sum(remitances_adj)) %>%
ggplot()+
geom_line(mapping = aes(x = date, y = gdp, group = 1),
color = "dark orange")+
geom_line(mapping = aes(x = date, y = remitance, group = 1))+
scale_y_continuous(labels = scales::comma)+
theme_graph()+
labs(title = "Per Capita GDP time series")
gdp <- gdp_pc %>%
mutate(gdp_pc = value) %>%
select(date, country, gdp_pc) %>%
inner_join(remitances, by = c("date" = "date", "country" = "country")) %>%
group_by(date) %>%
summarise(gdp = sum(gdp_pc),
remitance = sum(remitances_adj)) %>%
ggplot()+
geom_line(mapping = aes(x = date, y = gdp, group = 1),
color = "dark orange", size = 1)+
scale_y_continuous(labels = scales::comma)+
theme_graph()+
labs(title = "Per Capita GDP time series")
remittances <- gdp_pc %>%
mutate(gdp_pc = value) %>%
select(date, country, gdp_pc) %>%
inner_join(remitances, by = c("date" = "date", "country" = "country")) %>%
group_by(date) %>%
summarise(gdp = sum(gdp_pc),
remitance = sum(remitances_adj)) %>%
ggplot()+
geom_line(mapping = aes(x = date, y = remitance, group = 1),
color = "steel blue", size = 1)+
scale_y_continuous(labels = scales::comma)+
theme_graph()+
labs(title = "Per Capita Remitances time series")
gdp+remittances
remittances <- gdp_pc %>%
mutate(gdp_pc = value) %>%
select(date, country, gdp_pc) %>%
inner_join(remitances, by = c("date" = "date", "country" = "country")) %>%
group_by(date) %>%
summarise(gdp = sum(gdp_pc),
remitance = sum(remitances_adj)) %>%
ggplot()+
geom_line(mapping = aes(x = date, y = remitance, group = 1),
color = "steel blue", size = 1)+
scale_y_continuous(labels = scales::comma)+
theme_graph()+
labs(title = "Per Capita Remitances time series")
gdp+remittances
gdp <- gdp_pc %>%
mutate(gdp_pc = value) %>%
select(date, country, gdp_pc) %>%
inner_join(remitances, by = c("date" = "date", "country" = "country")) %>%
group_by(date) %>%
summarise(gdp = sum(gdp_pc),
remitance = sum(remitances_adj)) %>%
ggplot()+
geom_line(mapping = aes(x = date, y = gdp, group = 1),
color = "dark orange", size = 1)+
scale_y_continuous(labels = scales::comma)+
theme_graph()+
labs(title = "Per Capita GDP time series")
gdp+remittances
library(patchwork)
gdp+remittances
gdp <- gdp_pc %>%
mutate(gdp_pc = value) %>%
select(date, country, gdp_pc) %>%
inner_join(remitances, by = c("date" = "date", "country" = "country")) %>%
group_by(date) %>%
summarise(gdp = sum(gdp_pc),
remitance = sum(remitances_adj)) %>%
ggplot()+
geom_line(mapping = aes(x = date, y = gdp, group = 1),
color = "dark orange", size = 1)+
scale_y_continuous(labels = scales::comma)+
theme_graph()+
labs(title = "PIB per Capita")
remittances <- gdp_pc %>%
mutate(gdp_pc = value) %>%
select(date, country, gdp_pc) %>%
inner_join(remitances, by = c("date" = "date", "country" = "country")) %>%
group_by(date) %>%
summarise(gdp = sum(gdp_pc),
remitance = sum(remitances_adj)) %>%
ggplot()+
geom_line(mapping = aes(x = date, y = remitance, group = 1),
color = "steel blue", size = 1)+
scale_y_continuous(labels = scales::comma)+
theme_graph()+
labs(title = "Remittances per Capita")
gdp+remittances
gdp_pc %>%
mutate(gdp_pc = value) %>%
select(date, country, gdp_pc) %>%
inner_join(remitances, by = c("date" = "date", "country" = "country")) %>%
ggplot()+
geom_point(mapping = aes(x = remitances_adj, y = gdp_pc))+
geom_smooth(mapping = aes(x = remitances_adj, y = gdp_pc),
method = "lm",
formula = y ~ x,
se = F,
lty = 2,
color = "dark orange")+
scale_y_continuous(labels = scales::comma)+
scale_x_continuous(labels = scales::comma)+
theme_graph()+
labs(title = "Correlação do PIB per Capita e 'Remittances'",
y = "PIB per Capita",
x = "Remitances")
gdp_pc %>%
mutate(gdp_pc = value) %>%
select(date, country, gdp_pc) %>%
inner_join(remitances, by = c("date" = "date", "country" = "country")) %>%
lm(formula = remitances_adj ~ gdp_pc) %>%
summary() %>%
pander::pander()
blogdown::serve_site()
# Dataset sample
net_immigration[sample(nrow(net_immigration),5), ] %>%
knitr::kable(format.args = list(decimal.mark = ",", big.mark = "."))
blogdown::serve_site()
blogdown::stop_server()
rm(list = ls())
library(tidyverse)
library(Amelia)
library(gridExtra)
library(plot3D)
library(patchwork)
theme_graph <- function(){
theme(
plot.title = element_text(size = 16),
plot.subtitle = element_text(size = 12),
plot.caption = element_text(face = "italic", size = 9),
axis.text = element_text(size = 9),
axis.title = element_text(face = "italic", size = 9),
text = element_text(family = "Times New Roman"),
strip.background = element_rect(fill = "grey"),
strip.text = element_text(face = "bold"),
legend.title = element_blank(),
legend.position = "bottom"
)
}
path <- "C:/Users/francisco.piccolo/Desktop/R/franciscopiccolo.github.io/datasets/livro-econometria-basica-gujarati/"
path <- "C:/Users/francisco.piccolo/Desktop/R/franciscopiccolo.github.io/datasets/9999-99-99-basic_econometrics_by_gujarati/"
blogdown::serve_site()
blogdown::serve_site()
blogdown::stop_server()
