head()
# Joinning the population and net_immigration data
population %>%
filter(date == 2015) %>%
mutate(population = value) %>%
select(country, population) %>%
inner_join(net_immigration, by = c("country" = "country")) %>%
mutate(net_immigration_share = round(net_immigration/population, digits = 4)) %>%
arrange(net_immigration_share) %>%
head(20) %>%
mutate(country = fct_reorder(country, net_immigration_share)) %>%
ggplot()+
geom_col(mapping = aes(x = country, y = net_immigration_share),
fill = "dark orange",
alpha = .6)+
scale_y_continuous(labels = scales::percent)+
theme_graph()
# Joinning the population and net_immigration data
population %>%
filter(date == 2015) %>%
mutate(population = value) %>%
select(country, population) %>%
inner_join(net_immigration, by = c("country" = "country")) %>%
mutate(net_immigration_share = round(net_immigration/population, digits = 4)) %>%
arrange(net_immigration_share) %>%
head(20) %>%
mutate(net_immigration_share = net_immigration_share * -1,
country = fct_reorder(country, net_immigration_share)) %>%
ggplot()+
geom_col(mapping = aes(x = country, y = net_immigration_share),
fill = "dark orange",
alpha = .6)+
scale_y_continuous(labels = scales::percent)+
theme_graph()+
coord_flip()
# Joinning the population and net_immigration data
population %>%
filter(date == 2015) %>%
mutate(population = value) %>%
select(country, population) %>%
inner_join(net_immigration, by = c("country" = "country")) %>%
mutate(net_immigration_share = round(net_immigration/population, digits = 4)) %>%
arrange(net_immigration_share) %>%
head(20) %>%
mutate(net_immigration_share = net_immigration_share * -1,
country = fct_reorder(country, net_immigration_share)) %>%
ggplot()+
geom_col(mapping = aes(x = country, y = net_immigration_share),
fill = "dark orange",
alpha = .6)+
scale_y_continuous(labels = scales::percent)+
theme_graph()+
coord_flip()+
labs(title = "Share of population that left the country in the period",
x = "",
y = "",
caption = "From 2010 to 2017")
remitances_over_gdp <- wbstats::wb(indicator = "BX.TRF.PWKR.DT.GD.ZS",
country = "countries_only")
remitances_over_gdp %>%
filter(date == "2018",
country != "Lesotho",
value > 10) %>%
mutate(remitance_over_gdp = paste(round(value,digits = 0),"%",sep = "")) %>%
arrange(desc(value)) %>%
select(date,country,remitance_over_gdp)
remitances_received %>%
mutate(remitances = value) %>%
select(date, country, remitances) %>%
filter(country %in% country_view,
date > 2010) %>%
inner_join(population, by = c("date" = "date", "country" = "country")) %>%
head()
remitances_received <- wbstats::wb(indicator = "BX.TRF.PWKR.CD.DT",
country = "countries_only")
gdp_pc <- wbstats::wb(indicator = "NY.GDP.PCAP.CD",
country = "countries_only")
remitances_received %>%
mutate(remitances = value) %>%
select(date, country, remitances) %>%
filter(country %in% country_view,
date > 2010) %>%
inner_join(population, by = c("date" = "date", "country" = "country")) %>%
head()
# Creating a variable with the selected countries
country_view <- c("Yemen, Rep.","Tanzania","Uganda",
"Tunisia","Chad","Syrian Arab Republic",
"	Suriname","Somalia","Sierra Leone",
"Senegal","Sudan","Rwanda","Nepal",
"Nigeria","Malawi","Mali","Libya",
"Kenya","Ethiopia","Eritrea",
"Congo, Rep.")
remitances_received %>%
mutate(remitances = value) %>%
select(date, country, remitances) %>%
filter(country %in% country_view,
date > 2010) %>%
inner_join(population, by = c("date" = "date", "country" = "country")) %>%
head()
remitances_received %>%
mutate(remitances = value) %>%
select(date, country, remitances) %>%
filter(country %in% country_view,
date > 2010) %>%
inner_join(population, by = c("date" = "date", "country" = "country")) %>%
select(date, country, remitances, value) %>%
head()
remitances_received %>%
mutate(remitances = value) %>%
select(date, country, remitances) %>%
filter(country %in% country_view,
date > 2010) %>%
inner_join(population, by = c("date" = "date", "country" = "country")) %>%
select(date, country, remitances, value) %>%
mutate(remitances_adj = round(remitances/value, digits = 4)) %>%
head()
remitances_received %>%
mutate(remitances = value) %>%
select(date, country, remitances) %>%
filter(country %in% country_view,
date > 2010) %>%
inner_join(population, by = c("date" = "date", "country" = "country")) %>%
select(date, country, remitances, value) %>%
mutate(remitances_adj = round(remitances/value, digits = 4)) %>%
select(date, country, remitances_adj) %>%
head()
remitances_received %>%
mutate(remitances = value) %>%
select(date, country, remitances) %>%
filter(country %in% country_view,
date > 2010) %>%
inner_join(population, by = c("date" = "date", "country" = "country")) %>%
select(date, country, remitances, value) %>%
mutate(remitances_adj = round(remitances/value, digits = 4)) %>%
select(date, country, remitances_adj)
# Bringing population data from world bank
population <- wbstats::wb(indicator = "SP.POP.TOTL",
country = "countries_only")
remitances_received %>%
mutate(remitances = value) %>%
select(date, country, remitances) %>%
filter(country %in% country_view,
date > 2010) %>%
inner_join(population, by = c("date" = "date", "country" = "country")) %>%
select(date, country, remitances, value) %>%
mutate(remitances_adj = round(remitances/value, digits = 4)) %>%
select(date, country, remitances_adj)
remitances_received %>%
mutate(remitances = value) %>%
select(date, country, remitances) %>%
filter(country %in% country_view,
date > 2010) %>%
inner_join(population, by = c("date" = "date", "country" = "country")) %>%
select(date, country, remitances, value) %>%
mutate(remitances_adj = round(remitances/value, digits = 4)) %>%
select(date, country, remitances_adj) -> remitances
# Sample from dataset
remitances[sample(nrow(remitances),10), ]
# Sample from dataset
remitances[sample(nrow(remitances),5), ]
gdp_pc %>%
head()
gdp_pc %>%
select(date, country, value) %>%
inner_join(remitances, by = c("date" = "date", "country" = "country")) %>%
head()
gdp_pc %>%
mutate(gdp_pc = value) %>%
select(date, country, gdp_pc) %>%
inner_join(remitances, by = c("date" = "date", "country" = "country")) %>%
head()
gdp_pc %>%
mutate(gdp_pc = value) %>%
select(date, country, gdp_pc) %>%
inner_join(remitances, by = c("date" = "date", "country" = "country")) %>%
ggplot()+
geom_point(mapping = aes(x = remitances_adj, y = gdp_pc))
gdp_pc %>%
mutate(gdp_pc = value) %>%
select(date, country, gdp_pc) %>%
inner_join(remitances, by = c("date" = "date", "country" = "country")) %>%
ggplot()+
geom_point(mapping = aes(x = remitances_adj, y = gdp_pc))+
geom_smooth(mapping = aes(x = remitances_adj, y = gdp_pc),
method = "lm",
formula = y ~ x,
se = F,
lty = 2,
color = "dark orange")
gdp_pc %>%
mutate(gdp_pc = value) %>%
select(date, country, gdp_pc) %>%
inner_join(remitances, by = c("date" = "date", "country" = "country")) %>%
ggplot()+
geom_point(mapping = aes(x = remitances_adj, y = gdp_pc))+
geom_smooth(mapping = aes(x = remitances_adj, y = gdp_pc),
method = "lm",
formula = y ~ x,
se = F,
lty = 2,
color = "dark orange")+
theme_graph()+
labs(title = "Per Capita GDP and Remitances correlation",
y = "Per Capita GDP",
x = "Per Capita Remitances")
gdp_pc %>%
mutate(gdp_pc = value) %>%
select(date, country, gdp_pc) %>%
inner_join(remitances, by = c("date" = "date", "country" = "country")) %>%
head()
gdp_pc %>%
mutate(gdp_pc = value) %>%
select(date, country, gdp_pc) %>%
inner_join(remitances, by = c("date" = "date", "country" = "country")) %>%
lm(formula = remitances_adj ~ gdp_pc) %>%
summary()
blogdown::serve_site()
# Joining both datasets
migrants_pop %>%
filter(date == "2015") %>%
select(country, value) %>%
inner_join(population, by = c("country" = "country")) %>%
mutate(share_immigrants = round(value.x/value.y, digits = 4)) %>%
filter(value.y >= 10000000) %>%
arrange(desc(share_immigrants)) %>%
head(20) %>%
mutate(country = fct_reorder(country, share_immigrants)) %>%
ggplot()+
geom_col(mapping = aes(x = country, y = share_immigrants),
fill = "dark orange",
alpha = .6)+
scale_y_continuous(labels = scales::percent)+
theme_graph()+
labs(title = "County rank by imigration share over population",
x = "",
y = "% of imigrants over the population")+
coord_flip()
# Creating a variable with the data.frame of the requested data
migrants_pop <- wbstats::wb(indicator = "SM.POP.TOTL",
country = "countries_only",
startdate = 1980,
enddate = 2019)
migrants_pop %>%
group_by(date) %>%
summarise(immigrants = sum(value)) %>%
ggplot()+
geom_line(mapping = aes(x = date, y = immigrants, group = 1),
size = .5,
color = "dark orange",
alpha = .6)+
geom_point(mapping = aes(x = date, y = immigrants),
color = "dark orange")+
scale_y_continuous(labels = scales::comma)+
theme_graph()+
labs(title = "Immigrant's population during the years",
x = "",
y = "")
# Bringing population data from world bank
population <- wbstats::wb(indicator = "SP.POP.TOTL",
country = "countries_only")
# Joining both datasets
migrants_pop %>%
filter(date == "2015") %>%
select(country, value) %>%
inner_join(population, by = c("country" = "country")) %>%
mutate(share_immigrants = round(value.x/value.y, digits = 4)) %>%
filter(value.y >= 10000000) %>%
arrange(desc(share_immigrants)) %>%
head(20) %>%
mutate(country = fct_reorder(country, share_immigrants)) %>%
ggplot()+
geom_col(mapping = aes(x = country, y = share_immigrants),
fill = "dark orange",
alpha = .6)+
scale_y_continuous(labels = scales::percent)+
theme_graph()+
labs(title = "County rank by imigration share over population",
x = "",
y = "% of imigrants over the population")+
coord_flip()
migrants_pop
population
# Joining both datasets
migrants_pop %>%
filter(date == "2015") %>%
select(country, value) %>%
inner_join(population, by = c("country" = "country")) %>%
mutate(share_immigrants = round(value.x/value.y, digits = 4)) %>%
filter(value.y >= 10000000) %>%
arrange(desc(share_immigrants)) %>%
head(20) %>%
mutate(country = fct_reorder(country, share_immigrants)) %>%
ggplot()+
geom_col(mapping = aes(x = country, y = share_immigrants),
fill = "dark orange",
alpha = .6)+
scale_y_continuous(labels = scales::percent)+
theme_graph()+
labs(title = "County rank by imigration share over population",
x = "",
y = "% of imigrants over the population")+
coord_flip()
# Joining both datasets
migrants_pop %>%
filter(date == "2015") %>%
select(country, value) %>%
inner_join(population, by = c("country" = "country")) %>%
mutate(share_immigrants = round(value.x/value.y, digits = 4)) %>%
head()
# Joining both datasets
migrants_pop %>%
filter(date == "2015") %>%
select(country, value) %>%
inner_join(population, by = c("country" = "country")) %>%
mutate(share_immigrants = round(value.x/value.y, digits = 4)) %>%
filter(value.y >= 10000000) %>%
arrange(desc(share_immigrants)) %>%
head(20) %>%
head()
# Joining both datasets
migrants_pop %>%
filter(date == "2015") %>%
select(country, value) %>%
inner_join(population, by = c("country" = "country", "date" = "date")) %>%
mutate(share_immigrants = round(value.x/value.y, digits = 4)) %>%
filter(value.y >= 10000000) %>%
arrange(desc(share_immigrants)) %>%
head(20) %>%
mutate(country = fct_reorder(country, share_immigrants)) %>%
ggplot()+
geom_col(mapping = aes(x = country, y = share_immigrants),
fill = "dark orange",
alpha = .6)+
scale_y_continuous(labels = scales::percent)+
theme_graph()+
labs(title = "County rank by imigration share over population",
x = "",
y = "% of imigrants over the population")+
coord_flip()
population
# Joining both datasets
migrants_pop %>%
filter(date == "2015") %>%
select(country, value) %>%
inner_join(population, by = c("country" = "country", "date" = "date")) %>%
mutate(share_immigrants = round(value.x/value.y, digits = 4)) %>%
head()
migrants_pop
population
# Joining both datasets
migrants_pop %>%
filter(date == "2015") %>%
select(country, date, value) %>%
inner_join(population, by = c("country" = "country", "date" = "date")) %>%
mutate(share_immigrants = round(value.x/value.y, digits = 4)) %>%
filter(value.y >= 10000000) %>%
arrange(desc(share_immigrants)) %>%
head(20) %>%
mutate(country = fct_reorder(country, share_immigrants)) %>%
ggplot()+
geom_col(mapping = aes(x = country, y = share_immigrants),
fill = "dark orange",
alpha = .6)+
scale_y_continuous(labels = scales::percent)+
theme_graph()+
labs(title = "County rank by imigration share over population",
x = "",
y = "% of imigrants over the population")+
coord_flip()
remitances_received %>%
mutate(remitances = value) %>%
select(date, country, remitances) %>%
filter(country %in% country_view,
date > 2010) %>%
inner_join(population, by = c("date" = "date", "country" = "country")) %>%
select(date, country, remitances, value) %>%
mutate(remitances_adj = round(remitances/value, digits = 4)) %>%
select(date, country, remitances_adj) -> remitances
gdp_pc %>%
mutate(gdp_pc = value) %>%
select(date, country, gdp_pc) %>%
inner_join(remitances, by = c("date" = "date", "country" = "country")) %>%
ggplot()+
geom_point(mapping = aes(x = remitances_adj, y = gdp_pc))+
geom_smooth(mapping = aes(x = remitances_adj, y = gdp_pc),
method = "lm",
formula = y ~ x,
se = F,
lty = 2,
color = "dark orange")+
theme_graph()+
labs(title = "Per Capita GDP and Remitances correlation",
y = "Per Capita GDP",
x = "Per Capita Remitances")
gdp_pc %>%
mutate(gdp_pc = value) %>%
select(date, country, gdp_pc) %>%
inner_join(remitances, by = c("date" = "date", "country" = "country")) %>%
head()
gdp_pc %>%
mutate(gdp_pc = value) %>%
select(date, country, gdp_pc) %>%
inner_join(remitances, by = c("date" = "date", "country" = "country")) %>%
ggplot()+
geom_line(mapping = aes(x = date, y = gdp_pc))
gdp_pc %>%
mutate(gdp_pc = value) %>%
select(date, country, gdp_pc) %>%
inner_join(remitances, by = c("date" = "date", "country" = "country")) %>%
group_by(date) %>%
summarise(gdp = sum(gdp_pc),
remitance = sum(remitances_adj)) %>%
head()
gdp_pc %>%
mutate(gdp_pc = value) %>%
select(date, country, gdp_pc) %>%
inner_join(remitances, by = c("date" = "date", "country" = "country")) %>%
group_by(date) %>%
summarise(gdp = sum(gdp_pc),
remitance = sum(remitances_adj)) %>%
ggplot()+
geom_line(mapping = aes(x = date, y = gdp))
gdp_pc %>%
mutate(gdp_pc = value) %>%
select(date, country, gdp_pc) %>%
inner_join(remitances, by = c("date" = "date", "country" = "country")) %>%
group_by(date) %>%
summarise(gdp = sum(gdp_pc),
remitance = sum(remitances_adj)) %>%
ggplot()+
geom_line(mapping = aes(x = date, y = gdp, group = 1))
gdp_pc %>%
mutate(gdp_pc = value) %>%
select(date, country, gdp_pc) %>%
inner_join(remitances, by = c("date" = "date", "country" = "country")) %>%
group_by(date) %>%
summarise(gdp = sum(gdp_pc),
remitance = sum(remitances_adj)) %>%
ggplot()+
geom_line(mapping = aes(x = date, y = gdp, group = 1))+
geom_line(mapping = aes(x = date, y = remitance, group = 1))
gdp_pc %>%
mutate(gdp_pc = value) %>%
select(date, country, gdp_pc) %>%
inner_join(remitances, by = c("date" = "date", "country" = "country")) %>%
group_by(date) %>%
summarise(gdp = sum(gdp_pc),
remitance = sum(remitances_adj)) %>%
ggplot()+
geom_line(mapping = aes(x = date, y = gdp, group = 1))+
geom_line(mapping = aes(x = date, y = remitance, group = 1))+
scale_y_log10()
gdp_pc %>%
mutate(gdp_pc = value) %>%
select(date, country, gdp_pc) %>%
inner_join(remitances, by = c("date" = "date", "country" = "country")) %>%
group_by(date) %>%
summarise(gdp = sum(gdp_pc),
remitance = sum(remitances_adj)) %>%
ggplot()+
geom_line(mapping = aes(x = date, y = gdp, group = 1))
gdp_pc %>%
mutate(gdp_pc = value) %>%
select(date, country, gdp_pc) %>%
inner_join(remitances, by = c("date" = "date", "country" = "country")) %>%
group_by(date) %>%
summarise(gdp = sum(gdp_pc),
remitance = sum(remitances_adj)) %>%
ggplot()+
geom_line(mapping = aes(x = date, y = gdp, group = 1))+
scale_y_continuous(labels = scales::comma)+
theme_graph()+
labs(title = "Per Capita GDP time series")
gdp_pc %>%
mutate(gdp_pc = value) %>%
select(date, country, gdp_pc) %>%
inner_join(remitances, by = c("date" = "date", "country" = "country")) %>%
group_by(date) %>%
summarise(gdp = sum(gdp_pc),
remitance = sum(remitances_adj)) %>%
ggplot()+
geom_line(mapping = aes(x = date, y = gdp, group = 1),
color = "dark orange")+
scale_y_continuous(labels = scales::comma)+
theme_graph()+
labs(title = "Per Capita GDP time series")
gdp_pc %>%
mutate(gdp_pc = value) %>%
select(date, country, gdp_pc) %>%
inner_join(remitances, by = c("date" = "date", "country" = "country")) %>%
group_by(date) %>%
summarise(gdp = sum(gdp_pc),
remitance = sum(remitances_adj)) %>%
ggplot()+
geom_line(mapping = aes(x = date, y = remitance, group = 1))+
scale_y_continuous(labels = scales::comma)+
theme_graph()+
labs(title = "Per Capita Remitances time series")
gdp_pc %>%
mutate(gdp_pc = value) %>%
select(date, country, gdp_pc) %>%
inner_join(remitances, by = c("date" = "date", "country" = "country")) %>%
group_by(date) %>%
summarise(gdp = sum(gdp_pc),
remitance = sum(remitances_adj)) %>%
ggplot()+
geom_line(mapping = aes(x = date, y = remitance, group = 1),
color = "dark orange")+
scale_y_continuous(labels = scales::comma)+
theme_graph()+
labs(title = "Per Capita Remitances time series")
blogdown::stop_server()
