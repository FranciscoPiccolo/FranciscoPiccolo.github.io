tsibbledata::global_economy %>%
filter(Country == "United States") %>%
mutate(gdp_pc = GDP/Population) %>%
feasts::autoplot(gdp_pc)+
scale_y_continuous(labels = scales::comma)+
theme_graph()+
labs(title = "USA GDP wo Transformation")
tsibbledata::aus_livestock %>%
head()
tsibbledata::aus_livestock %>%
as.data.frame() %>%
select(Animal) %>%
distinct() %>%
head()
tsibbledata::aus_livestock %>%
filter(Animal == "Bulls, bullocks and steers") %>%
feasts::autoplot()
tsibbledata::aus_livestock %>%
filter(Animal == "Bulls, bullocks and steers") %>%
feasts::autoplot(Count)
tsibbledata::aus_livestock %>%
filter(Animal == "Bulls, bullocks and steers") %>%
group_by(Month) %>%
summarise(Count = sum(Count)) %>%
feasts::autoplot(Count)
tsibbledata::aus_livestock %>%
filter(Animal == "Bulls, bullocks and steers") %>%
as.data.frame() %>%
group_by(Month) %>%
summarise(Count = sum(Count)) %>%
as_tsibble(index = Month) %>%
feasts::autoplot(Count)
tsibbledata::aus_livestock %>%
filter(Animal == "Bulls, bullocks and steers") %>%
as.data.frame() %>%
group_by(Month) %>%
summarise(Count = sum(Count)) %>%
as_tsibble(index = Month) %>%
feasts::autoplot(Count)+
scale_y_continuous(labels = scales::comma)+
theme_graph()
tsibbledata::aus_livestock %>%
filter(Animal == "Bulls, bullocks and steers") %>%
features(Count, features = guerrero)
tsibbledata::aus_livestock %>%
filter(Animal == "Bulls, bullocks and steers") %>%
as.data.frame() %>%
group_by(Month) %>%
summarise(Count = sum(Count)) %>%
as_tsibble(index = Month) %>%
features(Count, features = guerrero)
tsibbledata::aus_livestock %>%
filter(Animal == "Bulls, bullocks and steers") %>%
as.data.frame() %>%
group_by(Month) %>%
summarise(Count = sum(Count)) %>%
as_tsibble(index = Month) %>%
features(Count, features = guerrero) %>%
pull(lambda_guerrero)
tsibbledata::aus_livestock %>%
filter(Animal == "Bulls, bullocks and steers") %>%
as.data.frame() %>%
group_by(Month) %>%
summarise(Count = sum(Count)) %>%
as_tsibble(index = Month) %>%
features(Count, features = guerrero) %>%
pull(name = lambda_guerrero)
lambda <- tsibbledata::aus_livestock %>%
filter(Animal == "Bulls, bullocks and steers") %>%
as.data.frame() %>%
group_by(Month) %>%
summarise(Count = sum(Count)) %>%
as_tsibble(index = Month) %>%
features(Count, features = guerrero) %>%
pull(name = lambda_guerrero)
tsibbledata::aus_livestock %>%
filter(Animal == "Bulls, bullocks and steers") %>%
as.data.frame() %>%
group_by(Month) %>%
summarise(Count = sum(Count)) %>%
as_tsibble(index = Month) %>%
feasts::autoplot(box_cox(Count, lambda = lambda))
tsibbledata::aus_livestock %>%
filter(Animal == "Bulls, bullocks and steers") %>%
as.data.frame() %>%
group_by(Month) %>%
summarise(Count = sum(Count)) %>%
as_tsibble(index = Month) %>%
feasts::autoplot(box_cox(Count, lambda = lambda))+
scale_y_continuous(labels = scales::comma)+
theme_graph()
tsibbledata::aus_livestock %>%
filter(Animal == "Bulls, bullocks and steers") %>%
as.data.frame() %>%
group_by(Month) %>%
summarise(Count = sum(Count)) %>%
as_tsibble(index = Month) %>%
feasts::autoplot(Count)+
scale_y_continuous(labels = scales::comma)+
theme_graph()
tsibbledata::aus_livestock %>%
filter(Animal == "Bulls, bullocks and steers") %>%
as.data.frame() %>%
group_by(Month) %>%
summarise(Count = sum(Count)) %>%
as_tsibble(index = Month) %>%
feasts::autoplot(box_cox(Count, lambda = lambda))+
scale_y_continuous(labels = scales::comma)+
theme_graph()
fpp3::canadian_gas %>%
head()
fpp3::canadian_gas %>%
feasts::autoplot()
lambda <- tsibbledata::aus_livestock %>%
filter(Animal == "Bulls, bullocks and steers") %>%
as.data.frame() %>%
group_by(Month) %>%
summarise(Count = sum(Count)) %>%
features(Count, features = guerrero) %>%
pull(name = lambda_guerrero)
lambda <-
fpp3::canadian_gas %>%
features(Volume, features = guerrero) %>%
pull(name = lambda)
lambda <-
fpp3::canadian_gas %>%
features(Volume, features = guerrero) %>%
pull(name = lambda_guerrero)
lambda
fpp3::canadian_gas %>%
feasts::autoplot(box_cox(Count, lambda))
fpp3::canadian_gas %>%
feasts::autoplot(box_cox(Volume, lambda))
with_box_cox <- fpp3::canadian_gas %>%
feasts::autoplot(box_cox(Volume, lambda))
wo_box_cox <-
fpp3::canadian_gas %>%
feasts::autoplot(Volume)
with_box_cox/wo_box_cox
with_box_cox+wo_box_cox
lambda
with_box_cox <- fpp3::canadian_gas %>%
feasts::autoplot(box_cox(Volume, 1))
with_box_cox+wo_box_cox
with_box_cox <- fpp3::canadian_gas %>%
feasts::autoplot(box_cox(Volume, 0))
wo_box_cox <-
fpp3::canadian_gas %>%
feasts::autoplot(Volume)
with_box_cox+wo_box_cox
exp(e)
log()
log(1)
exp(1)
fpp3::canadian_gas %>%
feasts::autoplot(log(Volume))
with_box_cox+wo_box_cox
BoxCox.lambda(fpp3::canadian_gas)
with_box_cox+wo_box_cox
library(GGally)
library(fpp3)
library(fable)
library(tsibble)
library(tsibbledata)
library(feasts)
library(tidyverse)
library(readr)
library(patchwork)
library(seasonal)
library(fma)
# Establishing graph theme
theme_graph <- function(){
theme(
plot.title = element_text(size = 16),
plot.subtitle = element_text(size = 12),
plot.caption = element_text(face = "italic", size = 9),
axis.text = element_text(size = 9),
axis.title = element_text(face = "italic", size = 9),
strip.background = element_rect(fill = "grey"),
strip.text = element_text(face = "bold"),
legend.title = element_blank(),
legend.position = "bottom"
)
}
tsibbledata::gafa_stock %>%
feasts::autoplot(size = 1)+
scale_color_brewer(type = "qual", palette = 2)+
theme_graph()+
labs(title = "Stock Price for Selected Companies",
subtitle = "Dataset - gafa_stock")
tsibbledata::PBS %>%
as.data.frame() %>%
group_by(Month, Type) %>%
summarise(Scripts = sum(Scripts),
Cost = sum(Cost)) %>%
mutate(ratio = Cost/Scripts) %>%
ggplot2::ggplot()+
geom_line(mapping = aes(x = Month, y = ratio, group = Type, color = Type))+
scale_color_brewer(type = "qual", palette = 2)+
theme_graph()+
labs(title = "Ratio of Cost over Scripts over Time")
tsibbledata::vic_elec %>%
feasts::gg_season(Demand, period = "week")+
scale_color_viridis_c()+
theme_graph()+
facet_wrap(~Holiday)
tsibbledata::vic_elec %>%
feasts::autoplot(Demand)
# Creating a dataset with max closing price for each company
tsibbledata::gafa_stock %>%
as.data.frame() %>%
group_by(Symbol) %>%
summarise(max_price = max(Close)) -> max_closing_price
# Using Inner join instead of filter
tsibbledata::gafa_stock %>%
as.data.frame() %>%
inner_join(max_closing_price, by = c("Symbol" = "Symbol", "Close" = "max_price")) %>%
knitr::kable(format.args = list(decimal.mark = ",", big.mark = "."),
caption = "Date of max closing price for each company")
tsibbledata::aus_production %>%
feasts::autoplot(color = "steel blue", size = 1)+
theme_graph()+
labs(title = "Clay Brick Production in Millions of Bricks")
fma::lynx %>%
feasts::autoplot(color = "steel blue", size = 1)+
scale_y_continuous(labels = scales::comma)+
theme_graph()+
labs(title = "Lynx Trapped on McKenzie River")
tsibbledata::gafa_stock %>%
select(Symbol, Date, Close) %>%
feasts::autoplot(size = 1)+
scale_color_brewer(type = "qual", palette = 6)+
theme_graph()+
labs(title = "Stock Closing Price for Selected Companies")
tsibbledata::vic_elec %>%
feasts::gg_season(Demand, period = "week")+
scale_color_viridis_c()+
theme_graph()+
labs(title = "Electricity Demand for Victoria - Australia")
fpp3::aus_arrivals %>%
feasts::autoplot(size = 1)+
scale_color_brewer(type = "qual", palette = 2)+
theme_graph()
fpp3::aus_arrivals %>%
feasts::autoplot(size = 1)+
scale_color_brewer(type = "qual", palette = 2)+
theme_graph()+
facet_wrap(~Origin)
fpp3::aus_arrivals %>%
feasts::gg_season(Arrivals, period = "year")+
scale_color_continuous()
fpp3::aus_arrivals %>%
feasts::gg_subseries(Arrivals)
fpp3::us_employment %>%
filter(Title == "Total Private") %>%
feasts::autoplot(Employed)+
scale_y_continuous(labels = scales::comma)+
theme_graph()+
labs(title = "# of people employed over time",
subtitle = "Trend and Seasonality",
x = "")
fpp3::us_employment %>%
filter(Title == "Total Private") %>%
feasts::gg_season(Employed, alpha = .4, size = 1)+
scale_color_continuous()+
scale_y_continuous(labels = scales::comma)+
theme_graph()+
labs(title = "Employed over time segmented by Month",
subtitle = "Verifying monthly seasonality")
fpp3::us_employment %>%
filter(Title == "Total Private") %>%
mutate(month = as.character(lubridate::month(Month))) %>%
ggplot2::ggplot()+
geom_boxplot(mapping = aes(x = month, y = Employed))
fpp3::us_employment %>%
filter(Title == "Total Private") %>%
feasts::gg_subseries(Employed, period = "year")+
scale_y_continuous(labels = scales::comma)+
theme_graph()+
labs(title = "Looking at seasonality for each month",
subtitle = "January with lower number of people employed")
fpp3::us_employment %>%
filter(Title == "Total Private") %>%
feasts::gg_lag(Employed, geom = "point", lags = 1:12)
tsibbledata::aus_production %>%
select(Quarter, Bricks) %>%
feasts::gg_season(Bricks, period = "year")+
scale_color_continuous()+
labs(title = "Verifying Bricks Production Seasonality",
subtitle = "Spike production on Q3")
tsibbledata::aus_production %>%
select(Quarter, Bricks) %>%
feasts::gg_subseries(Bricks)+
theme_graph()+
labs(title = "Verifying seasonality on Bricks Production",
subtitle = "Confirming Q3 peak")
tsibbledata::pelt %>%
feasts::autoplot()
tsibbledata::pelt %>%
feasts::ACF(Hare, lag_max = 20) %>%
feasts::autoplot()+
labs(title = "Autocorrelation Plot for the series",
subtitle = "Strong correlation on t-1 and t-5 (five years seasonality)")
tsibbledata::PBS %>%
filter(ATC2 == "H02") %>%
feasts::autoplot(Cost)+
theme_graph()+
theme(legend.position = "none")+
scale_color_brewer(type = "qual", palette = 2)+
scale_y_continuous(labels = scales::comma)+
facet_wrap(Type~Concession, scales = "free_y")
# Require tidyverse; patchwork; feasts; tsibbledata
tsibbledata::PBS %>%
filter(ATC2 == "H02",
Concession == "Concessional",
Type == "Co-payments") %>%
feasts::gg_season(Cost)+
scale_y_continuous(labels = scales::comma)+
scale_color_viridis_c()+
theme_graph()+
labs(title = "Concessional for Co-Payments",
subtitle = "Lower values for December")
tsibbledata::PBS %>%
filter(ATC2 == "H02",
Concession == "Concessional",
Type == "Co-payments") %>%
feasts::gg_subseries(Cost)+
scale_y_continuous(labels = scales::comma)+
scale_color_viridis_c()+
theme_graph()+
labs(title = "Concessional for Co-Payments",
subtitle = "Lower values for January and December")
country_list <- c("Argentina","Brazil","Chile","Peru","Colombia","United States","France","China","Japan","Russia")
tsibbledata::global_economy %>%
filter(Country %in% c(country_list)) %>%
mutate(gdp_pc = GDP/Population) %>%
feasts::autoplot(gdp_pc, size = 1)
tsibbledata::global_economy %>%
filter(Year == max(Year)) %>%
select(Country, GDP, Population) %>%
mutate(gdp_pc = GDP/Population) %>%
arrange(desc(gdp_pc)) %>%
head(30) %>%
mutate(Country = fct_reorder(Country, gdp_pc)) %>%
ggplot2::ggplot()+
geom_col(mapping = aes(x = Country, y = gdp_pc), fill = "steel blue")+
scale_y_continuous(labels = scales::comma)+
coord_flip()+
theme_graph()+
labs(title = "Top 30 Countries Classified by Per Capita GDP")
tsibbledata::global_economy %>%
filter(Country == "United States") %>%
feasts::autoplot(GDP)+
scale_y_continuous(labels = scales::comma)+
theme_graph()+
labs(title = "USA GDP wo Transformation")
tsibbledata::global_economy %>%
filter(Country == "United States") %>%
mutate(gdp_pc = GDP/Population) %>%
feasts::autoplot(gdp_pc)+
scale_y_continuous(labels = scales::comma)+
theme_graph()+
labs(title = "USA GDP per Capita")
tsibbledata::aus_livestock %>%
filter(Animal == "Bulls, bullocks and steers") %>%
as.data.frame() %>%
group_by(Month) %>%
summarise(Count = sum(Count)) %>%
as_tsibble(index = Month) %>%
feasts::autoplot(Count)+
scale_y_continuous(labels = scales::comma)+
theme_graph()
lambda <- tsibbledata::aus_livestock %>%
filter(Animal == "Bulls, bullocks and steers") %>%
as.data.frame() %>%
group_by(Month) %>%
summarise(Count = sum(Count)) %>%
as_tsibble(index = Month) %>%
features(Count, features = guerrero) %>%
pull(name = lambda_guerrero)
tsibbledata::aus_livestock %>%
filter(Animal == "Bulls, bullocks and steers") %>%
as.data.frame() %>%
group_by(Month) %>%
summarise(Count = sum(Count)) %>%
as_tsibble(index = Month) %>%
feasts::autoplot(box_cox(Count, lambda = lambda))+
scale_y_continuous(labels = scales::comma)+
theme_graph()
lambda <-
fpp3::canadian_gas %>%
features(Volume, features = guerrero) %>%
pull(name = lambda_guerrero)
with_box_cox <- fpp3::canadian_gas %>%
feasts::autoplot(box_cox(Volume, 0))
wo_box_cox <-
fpp3::canadian_gas %>%
feasts::autoplot(Volume)
with_box_cox+wo_box_cox
gas <- tail(aus_production, 5*4) %>% select(Gas)
gas
tsibbledata::aus_production %>%
head()
tsibbledata::aus_production %>%
select(Quarter, Tobacco) %>%
head()
tsibbledata::aus_production %>%
select(Quarter, Tobacco) %>%
feasts::autoplot()
tsibbledata::aus_production %>%
select(Quarter, Tobacco) %>%
feasts::autoplot(box_cox())
tsibbledata::aus_production %>%
select(Quarter, Tobacco) %>%
feasts::autoplot(box_cox(Tobacco, 0))
tsibbledata::aus_production %>%
select(Quarter, Tobacco) %>%
feasts::autoplot(box_cox(Tobacco, 0.3))
lambda <-
tsibbledata::aus_production %>%
features(Tobacco, features = guerrero) %>%
head()
lambda
tsibbledata::aus_production %>%
select(Quarter, Tobacco) %>%
feasts::autoplot(box_cox(Tobacco, 0.929))
tsibbledata::aus_production %>%
select(Quarter, Tobacco) %>%
feasts::autoplot(Tobacco)
tsibble::tourism %>%
features(Trips, feasts::feat_stl)
setwd("C:/Users/fppicco/Desktop/R/Github/franciscopiccolo.github.io")
blogdown::serve_site()
tsibbledata::aus_production %>%
head()
tsibbledata::aus_production %>%
select(Quarter, Bricks) %>%
head()
tsibbledata::aus_production %>%
select(Quarter, Bricks) %>%
head() %>%
knitr::kable(format.args = list(big.mark = ".", decimal.mark = ","))
blogdown::stop_server()
tsibbledata::aus_production %>%
select(Quarter, Bricks) %>%
head() %>%
knitr::kable(format.args = list(big.mark = ".", decimal.mark = ","))
tsibbledata::aus_production %>%
select(Quarter, Bricks) %>%
feasts::autoplot(Bricks)
tsibbledata::aus_production %>%
select(Quarter, Bricks) %>%
feasts::autoplot(Bricks)+
theme_graph()
tsibbledata::aus_production %>%
select(Quarter, Bricks) %>%
feasts::autoplot(Bricks)+
theme_graph()+
labs(title = "Produção Trimestral de Barro")
tsibbledata::aus_production %>%
select(Quarter, Bricks) %>%
feasts::gg_season()
tsibbledata::aus_production %>%
select(Quarter, Bricks) %>%
feasts::gg_subseries()
tsibbledata::aus_production %>%
select(Quarter, Bricks) %>%
feasts::autoplot(Bricks)+
theme_graph()+
labs(title = "Produção Trimestral de Barro")
tsibbledata::aus_production %>%
select(Quarter, Bricks) %>%
feasts::gg_subseries()
tsibbledata::aus_production %>%
select(Quarter, Bricks) %>%
feasts::autoplot(Bricks)+
theme_graph()+
labs(title = "Produção Trimestral de Barro")
tsibbledata::aus_production %>%
select(Quarter, Bricks) %>%
feasts::autoplot(Bricks)+
theme_graph()+
labs(title = "Produção Trimestral de Barro",
subtitle = "Série sem tendência porém com forte sazonalidade")
tsibbledata::aus_production %>%
select(Quarter, Bricks) %>%
feasts::gg_subseries()
tsibbledata::aus_production %>%
select(Quarter, Bricks) %>%
feasts::gg_subseries()+
theme_graph()+
labs(title = "Produção em cada trimestre",
subtitle = "Forte queda no 1º trimestre")
tsibbledata::aus_production %>%
select(Quarter, Bricks) %>%
feasts::gg_subseries()+
theme_graph()+
labs(title = "Produção em cada trimestre")
tsibbledata::aus_production %>%
select(Quarter, Bricks) %>%
feasts::autoplot(Bricks)+
theme_graph()+
labs(title = "Produção Trimestral de Barro",
subtitle = "Série sem tendência porém com forte sazonalidade")
tsibbledata::aus_production %>%
select(Quarter, Bricks) %>%
feasts::gg_subseries()+
theme_graph()+
labs(title = "Produção em cada trimestre")
tsibbledata::aus_production %>%
select(Quarter, Bricks) %>%
decompose(STL())
