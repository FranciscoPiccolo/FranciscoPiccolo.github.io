select(product_family) %>%
distinct() %>%
head()
q2 %>%
select(product_family) %>%
distinct() %>%
head(10)
q2 %>%
filter(region != "other",
product_family == "Media") %>%
group_by(asin, asin_desc, gl_product_group_desc, product_family, total_asins, total_asins_per_product_family, total_asins_per_gl, asin_qty) %>%
summarise(asin_qty_2 = sum(asin_qty)) %>%
View()
q2 %>%
filter(region != "other",
product_family == "Media") %>%
group_by(asin, asin_desc, gl_product_group_desc, product_family, total_asins, total_asins_per_product_family, total_asins_per_gl, asin_qty) %>%
mutate(share_over_total = asin_qty/total_asins_per_product_family) %>%
select(asin, share_over_total) %>%
mutate(cum_sum = cumsum(share_over_total),
index = row_number()) -> asin_impact_media
q2 %>%
filter(region != "other",
product_family == "Media") %>%
mutate(share_over_total = asin_qty/total_asins_per_product_family) %>%
select(asin, share_over_total) %>%
mutate(cum_sum = cumsum(share_over_total),
index = row_number()) -> asin_impact_media
asin_impact_media
q2 %>%
filter(region != "other",
product_family == "Media") %>%
mutate(share_over_total = asin_qty/total_asins_per_product_family) %>%
select(asin, share_over_total) %>%
mutate(cum_sum = cumsum(share_over_total),
index = row_number()) %>%
View()
q2 %>%
filter(region != "other",
product_family == "Media") %>%
mutate(share_over_total = asin_qty/total_asins_per_product_family) %>%
select(asin, share_over_total) %>%
mutate(cum_sum = cumsum(share_over_total),
index = row_number()) -> asin_impact_media
q2 %>%
select(product_family) %>%
distinct() %>%
head(10)
q2 %>%
filter(region != "other",
product_family == "Digital") %>%
mutate(share_over_total = asin_qty/total_asins_per_product_family) %>%
select(asin, share_over_total) %>%
mutate(cum_sum = cumsum(share_over_total),
index = row_number()) -> asin_impact_Digital
q2 %>%
filter(region != "other") %>%
group_by(asin, asin_desc, gl_product_group_desc, product_family, total_asins, total_asins_per_product_family, total_asins_per_gl) %>%
summarise(asin_qty = sum(asin_qty)) %>%
ungroup() %>%
mutate(share_over_total = asin_qty/total_asins) %>%
select(asin, share_over_total) %>%
mutate(cum_sum = cumsum(share_over_total),
index = row_number(),
metric_name = "total") -> asin_impact_total
q2 %>%
filter(region != "other") %>%
mutate(share_over_total = asin_qty/total_asins) %>%
select(asin, share_over_total) %>%
mutate(cum_sum = cumsum(share_over_total),
index = row_number(),
metric_name = "total") -> asin_impact_total
asin_impact_total
q2 %>%
filter(region != "other") %>%
mutate(share_over_total = asin_qty/total_asins) %>%
select(asin, share_over_total) %>%
arrange(desc(share_over_total)) %>%
mutate(cum_sum = cumsum(share_over_total),
index = row_number(),
metric_name = "total") -> asin_impact_total
asin_impact_total
q2 %>%
filter(region != "other",
product_family == "Media") %>%
mutate(share_over_total = asin_qty/total_asins_per_product_family) %>%
select(asin, share_over_total) %>%
arrange(desc(share_over_total)) %>%
mutate(cum_sum = cumsum(share_over_total),
index = row_number(),
metric_name = "media") -> asin_impact_media
q2 %>%
filter(region != "other",
product_family == "Digital") %>%
mutate(share_over_total = asin_qty/total_asins_per_product_family) %>%
select(asin, share_over_total) %>%
arrange(desc(share_over_total)) %>%
mutate(cum_sum = cumsum(share_over_total),
index = row_number(),
metric_name = "digital") -> asin_impact_Digital
asin_impact_total %>%
union_all(asin_impact_media) %>%
union_all(asin_impact_Digital) %>%
ggplot2::ggplot()+
geom_line(mapping = aes(x = index, y = cum_sum, color = "metric_name"))+
theme_graph()+
scale_y_continuous(labels = scales::percent)+
labs(title = "N of Asins that were shipped from XBRB to South and Southeast",
subtitle = "Cummulative % Impact for each asin",
x = "N of Asins",
y = "Cum % Impact",
caption = "Last 10 days of shipments
100% means the share of South and Southeast attended by XBRB ~2%")
asin_impact_total %>%
union_all(asin_impact_media) %>%
union_all(asin_impact_Digital) %>%
View()
ggplot2::ggplot()+
geom_line(mapping = aes(x = index, y = cum_sum))+
theme_graph()+
scale_y_continuous(labels = scales::percent)+
facet_wrap(~metric_name)+
labs(title = "N of Asins that were shipped from XBRB to South and Southeast",
subtitle = "Cummulative % Impact for each asin",
x = "N of Asins",
y = "Cum % Impact",
caption = "Last 10 days of shipments
100% means the share of South and Southeast attended by XBRB ~2%")
asin_impact_total %>%
union_all(asin_impact_media) %>%
union_all(asin_impact_Digital) %>%
ggplot2::ggplot()+
geom_line(mapping = aes(x = index, y = cum_sum))+
theme_graph()+
scale_y_continuous(labels = scales::percent)+
facet_wrap(~metric_name)+
labs(title = "N of Asins that were shipped from XBRB to South and Southeast",
subtitle = "Cummulative % Impact for each asin",
x = "N of Asins",
y = "Cum % Impact",
caption = "Last 10 days of shipments
100% means the share of South and Southeast attended by XBRB ~2%")
asin_impact_total %>%
union_all(asin_impact_media) %>%
union_all(asin_impact_Digital) %>%
ggplot2::ggplot()+
geom_line(mapping = aes(x = index, y = cum_sum))+
theme_graph()+
scale_y_continuous(labels = scales::percent)+
facet_wrap(~metric_name, scales = "free_x")+
labs(title = "N of Asins that were shipped from XBRB to South and Southeast",
subtitle = "Cummulative % Impact for each asin",
x = "N of Asins",
y = "Cum % Impact",
caption = "Last 10 days of shipments
100% means the share of South and Southeast attended by XBRB ~2%")
q2 %>%
select(product_family) %>%
distinct() %>%
head(10)
q2 %>%
filter(region != "other",
product_family == "Consumables") %>%
mutate(share_over_total = asin_qty/total_asins_per_product_family) %>%
select(asin, share_over_total) %>%
arrange(desc(share_over_total)) %>%
mutate(cum_sum = cumsum(share_over_total),
index = row_number(),
metric_name = "consumables") -> asin_impact_consumables
q2 %>%
filter(region != "other",
product_family == "Softlines") %>%
mutate(share_over_total = asin_qty/total_asins_per_product_family) %>%
select(asin, share_over_total) %>%
arrange(desc(share_over_total)) %>%
mutate(cum_sum = cumsum(share_over_total),
index = row_number(),
metric_name = "softlines") -> asin_impact_softlines
q2 %>%
filter(region != "other",
product_family == "Hardlines") %>%
mutate(share_over_total = asin_qty/total_asins_per_product_family) %>%
select(asin, share_over_total) %>%
arrange(desc(share_over_total)) %>%
mutate(cum_sum = cumsum(share_over_total),
index = row_number(),
metric_name = "hardlines") -> asin_impact_hardlines
asin_impact_total %>%
union_all(asin_impact_media) %>%
union_all(asin_impact_Digital) %>%
union_all(asin_impact_consumables) %>%
union_all(asin_impact_softlines) %>%
union_all(asin_impact_hardlines) %>%
ggplot2::ggplot()+
geom_line(mapping = aes(x = index, y = cum_sum))+
theme_graph()+
scale_y_continuous(labels = scales::percent)+
facet_wrap(~metric_name, scales = "free_x")+
labs(title = "N of Asins that were shipped from XBRB to South and Southeast",
subtitle = "Cummulative % Impact for each asin",
x = "N of Asins",
y = "Cum % Impact",
caption = "Last 10 days of shipments
100% means the share of South and Southeast attended by XBRB ~2%")
q2 %>%
head()
q2 %>%
group_by(product_family, total_asins, total_asins_per_product_family) %>%
mutate(share_per_pf = total_asins_per_product_family/total_asins) %>%
head()
q2 %>%
mutate(share_per_pf = total_asins_per_product_family/total_asins) %>%
head()
q2 %>%
mutate(share_per_pf = total_asins_per_product_family/total_asins) %>%
distinct(product_family, share_per_pf) %>%
head()
q2 %>%
mutate(share_per_pf = total_asins_per_product_family/total_asins) %>%
distinct(product_family, share_per_pf) %>%
arrange(desc(share_per_pf))
q2 %>%
filter(region != "other") %>%
mutate(share_per_pf = total_asins_per_product_family/total_asins) %>%
distinct(product_family, share_per_pf) %>%
arrange(desc(share_per_pf))
q2 %>%
filter(region != "other") %>%
mutate(share_per_pf = total_asins_per_gl/total_asins) %>%
distinct(gl_product_group_desc, share_per_pf) %>%
arrange(desc(share_per_pf))
q2 %>%
filter(region != "other") %>%
mutate(share_per_gl = total_asins_per_gl/total_asins) %>%
distinct(gl_product_group_desc, share_per_pl) %>%
arrange(desc(share_per_gl))
q2 %>%
filter(region != "other") %>%
mutate(share_per_gl = total_asins_per_gl/total_asins) %>%
distinct(gl_product_group_desc, share_per_gl) %>%
arrange(desc(share_per_gl))
q2 %>%
filter(region != "other") %>%
mutate(share_per_gl = total_asins_per_gl/total_asins) %>%
distinct(gl_product_group_desc, share_per_gl) %>%
mutate(gl_product_group_desc = fct_reorder(gl_product_group_desc, share_per_gl, .desc = T)) %>%
ggplot2::ggplot()+
geom_col(mapping = aes(x = gl_product_group_desc, y = share_per_gl))+
coord_flip()
q2 %>%
filter(region != "other") %>%
mutate(share_per_gl = total_asins_per_gl/total_asins) %>%
distinct(gl_product_group_desc, share_per_gl) %>%
mutate(gl_product_group_desc = fct_reorder(gl_product_group_desc, share_per_gl, .desc = F)) %>%
ggplot2::ggplot()+
geom_col(mapping = aes(x = gl_product_group_desc, y = share_per_gl))+
coord_flip()
q2 %>%
filter(region != "other") %>%
mutate(share_per_gl = total_asins_per_gl/total_asins) %>%
distinct(gl_product_group_desc, share_per_gl) %>%
mutate(gl_product_group_desc = fct_reorder(gl_product_group_desc, share_per_gl, .desc = F)) %>%
ggplot2::ggplot()+
geom_col(mapping = aes(x = gl_product_group_desc, y = share_per_gl), fill = "steel blue")+
coord_flip()
q2 %>%
filter(region != "other") %>%
mutate(share_per_gl = total_asins_per_gl/total_asins) %>%
distinct(gl_product_group_desc, share_per_gl) %>%
mutate(gl_product_group_desc = fct_reorder(gl_product_group_desc, share_per_gl, .desc = F)) %>%
ggplot2::ggplot()+
geom_col(mapping = aes(x = gl_product_group_desc, y = share_per_gl), fill = "steel blue")+
scale_y_continuous(labels = scales::percent)+
coord_flip()
asin_impact_total %>%
union_all(asin_impact_media) %>%
union_all(asin_impact_Digital) %>%
union_all(asin_impact_consumables) %>%
union_all(asin_impact_softlines) %>%
union_all(asin_impact_hardlines) %>%
ggplot2::ggplot()+
geom_line(mapping = aes(x = index, y = cum_sum))+
theme_graph()+
scale_y_continuous(labels = scales::percent)+
facet_wrap(~metric_name, scales = "free_x")+
labs(title = "N of Asins that were shipped from XBRB to South and Southeast",
subtitle = "Cummulative % Impact for each asin",
x = "N of Asins",
y = "Cum % Impact",
caption = "Last 10 days of shipments
100% means the share of South and Southeast attended by XBRB ~2%")
asin_impact_total %>%
union_all(asin_impact_media) %>%
union_all(asin_impact_Digital) %>%
union_all(asin_impact_consumables) %>%
union_all(asin_impact_softlines) %>%
union_all(asin_impact_hardlines) %>%
ggplot2::ggplot()+
geom_line(mapping = aes(x = index, y = cum_sum, color = metric_name))+
theme_graph()+
scale_y_continuous(labels = scales::percent)+
scale_color_viridis_d()+
facet_wrap(~metric_name, scales = "free_x")+
labs(title = "N of Asins that were shipped from XBRB to South and Southeast",
subtitle = "Cummulative % Impact for each asin",
x = "N of Asins",
y = "Cum % Impact",
caption = "Last 10 days of shipments
100% means the share of South and Southeast attended by XBRB ~2%")
asin_impact_total %>%
union_all(asin_impact_media) %>%
union_all(asin_impact_Digital) %>%
union_all(asin_impact_consumables) %>%
union_all(asin_impact_softlines) %>%
union_all(asin_impact_hardlines) %>%
ggplot2::ggplot()+
geom_line(mapping = aes(x = index, y = cum_sum, color = metric_name))+
theme_graph()+
theme(legend.position = "none")+
scale_y_continuous(labels = scales::percent)+
scale_color_viridis_d()+
facet_wrap(~metric_name, scales = "free_x")+
labs(title = "N of Asins that were shipped from XBRB to South and Southeast",
subtitle = "Cummulative % Impact for each asin",
x = "N of Asins",
y = "Cum % Impact",
caption = "Last 10 days of shipments
100% means the share of South and Southeast attended by XBRB ~2%")
asin_impact_total %>%
union_all(asin_impact_media) %>%
union_all(asin_impact_Digital) %>%
union_all(asin_impact_consumables) %>%
union_all(asin_impact_softlines) %>%
union_all(asin_impact_hardlines) %>%
ggplot2::ggplot()+
geom_line(mapping = aes(x = index, y = cum_sum, color = metric_name), size = 1)+
theme_graph()+
theme(legend.position = "none")+
scale_y_continuous(labels = scales::percent)+
scale_color_viridis_d()+
facet_wrap(~metric_name, scales = "free_x")+
labs(title = "N of Asins that were shipped from XBRB to South and Southeast",
subtitle = "Cummulative % Impact for each asin",
x = "N of Asins",
y = "Cum % Impact",
caption = "Last 10 days of shipments
100% means the share of South and Southeast attended by XBRB ~2%")
q2 %>%
filter(region != "other") %>%
group_by(asin, asin_desc, gl_product_group_desc, product_family, total_asins, total_asins_per_product_family, total_asins_per_gl) %>%
summarise(asin_qty = sum(asin_qty)) %>%
arrange(desc(asin_qty)) %>%
mutate(share_over_total = asin_qty/total_asins) %>%
head(200) %>%
group_by() %>%
summarise(total = sum(share_over_total))
q1 %>%
filter(year == 2020,
ship_datetime >= Sys.Date()-90,
region %in% c("south","southeast")) %>%
group_by(week, warehouse_id) %>%
summarise(shipped_units = sum(shipped_units)) %>%
mutate(is_xbrb = as.factor(if_else(warehouse_id == "XBRB",1,0))) %>%
ggplot2::ggplot()+
geom_col(mapping = aes(x = week, y = shipped_units, fill = is_xbrb), position = "fill")+
scale_fill_viridis_d()+
theme_graph()+
theme(legend.position = "right",
legend.title = element_text())+
labs(title = "% shipped units from XBRB to South/Southeast",
x = "Weeks",
y = "% share",
fill = "is_xbrb")
q1 %>%
filter(year == 2020,
region != "missing") %>%
group_by(week, warehouse_id, region) %>%
summarise(shipped_units = sum(shipped_units)) %>%
mutate(is_xbrb = as.factor(if_else(warehouse_id == "XBRB",1,0))) %>%
ggplot2::ggplot()+
geom_line(mapping = aes(x = week, y = shipped_units, group = warehouse_id, color = is_xbrb), size = 1)+
scale_color_viridis_d()+
scale_y_continuous(labels = scale::comma)+
theme_graph()+
facet_wrap(~region, scales = "free_y")
q1 %>%
filter(year == 2020,
region != "missing") %>%
group_by(week, warehouse_id, region) %>%
summarise(shipped_units = sum(shipped_units)) %>%
mutate(is_xbrb = as.factor(if_else(warehouse_id == "XBRB",1,0))) %>%
ggplot2::ggplot()+
geom_line(mapping = aes(x = week, y = shipped_units, group = warehouse_id, color = is_xbrb), size = 1)+
scale_color_viridis_d()+
scale_y_continuous(labels = scales::comma)+
theme_graph()+
facet_wrap(~region, scales = "free_y")
q2 %>%
filter(gl_product_group_desc == "gl_drugstore") %>%
View()
asin_impact_media %>%
head()
q2 %>%
filter(region != "other") %>%
mutate(share_over_total = asin_qty/total_asins) %>%
select(asin, asin_desc, share_over_total) %>%
arrange(desc(share_over_total)) %>%
mutate(cum_sum = cumsum(share_over_total),
index = row_number(),
metric_name = "total") -> asin_impact_total
q2 %>%
filter(region != "other",
product_family == "Media") %>%
mutate(share_over_total = asin_qty/total_asins_per_product_family) %>%
select(asin, asin_desc, share_over_total) %>%
arrange(desc(share_over_total)) %>%
mutate(cum_sum = cumsum(share_over_total),
index = row_number(),
metric_name = "media") -> asin_impact_media
q2 %>%
filter(region != "other",
product_family == "Digital") %>%
mutate(share_over_total = asin_qty/total_asins_per_product_family) %>%
select(asin, asin_desc, share_over_total) %>%
arrange(desc(share_over_total)) %>%
mutate(cum_sum = cumsum(share_over_total),
index = row_number(),
metric_name = "digital") -> asin_impact_Digital
q2 %>%
filter(region != "other",
product_family == "Consumables") %>%
mutate(share_over_total = asin_qty/total_asins_per_product_family) %>%
select(asin, asin_desc, share_over_total) %>%
arrange(desc(share_over_total)) %>%
mutate(cum_sum = cumsum(share_over_total),
index = row_number(),
metric_name = "consumables") -> asin_impact_consumables
q2 %>%
filter(region != "other",
product_family == "Softlines") %>%
mutate(share_over_total = asin_qty/total_asins_per_product_family) %>%
select(asin, asin_desc, share_over_total) %>%
arrange(desc(share_over_total)) %>%
mutate(cum_sum = cumsum(share_over_total),
index = row_number(),
metric_name = "softlines") -> asin_impact_softlines
q2 %>%
filter(region != "other",
product_family == "Hardlines") %>%
mutate(share_over_total = asin_qty/total_asins_per_product_family) %>%
select(asin, asin_desc, share_over_total) %>%
arrange(desc(share_over_total)) %>%
mutate(cum_sum = cumsum(share_over_total),
index = row_number(),
metric_name = "hardlines") -> asin_impact_hardlines
asin_impact_total %>%
union_all(asin_impact_media) %>%
union_all(asin_impact_Digital) %>%
union_all(asin_impact_consumables) %>%
union_all(asin_impact_softlines) %>%
union_all(asin_impact_hardlines) %>%
ggplot2::ggplot()+
geom_line(mapping = aes(x = index, y = cum_sum, color = metric_name), size = 1)+
theme_graph()+
theme(legend.position = "none")+
scale_y_continuous(labels = scales::percent)+
scale_x_continuous(labels = scales::comma)+
scale_color_viridis_d()+
facet_wrap(~metric_name, scales = "free_x")+
labs(title = "N of Asins that were shipped from XBRB to South and Southeast",
subtitle = "Cummulative % Impact for each asin",
x = "N of Asins",
y = "Cum % Impact",
caption = "Last 10 days of shipments
100% means the share of South and Southeast attended by XBRB ~2%")
asin_impact_media %>%
head()
asin_impact_media %>%
head(50) %>%
head()
asin_impact_media %>%
head(50) %>%
mutate(total_impact = sum(share_over_total)) %>%
View()
asin_impact_hardlines %>%
head(50) %>%
mutate(total_impact = sum(share_over_total))
asin_impact_Digital
setwd("C:/Users/fppicco/Desktop/R/Github/franciscopiccolo.github.io")
blogdown::build_site()
blogdown::install_hugo()
blogdown::build_site()
install.packages("wbstats")
install.packages("corrplot")
install.packages("lmtest")
install.packages("lmtest")
# Getting the dataset
dados <- readxl::read_excel("C:/Users/fppicco/Desktop/R/Github/franciscopiccolo.github.io/datasets/Econometria_exercicios/autocorrelacao_cana_de_acucar.xlsx")
blogdown::serve_site()
blogdown::stop_server()
blogdown::serve_site()
blogdown::stop_server()
blogdown::build_site()
blogdown::build_site()
blogdown::serve_site()
blogdown::stop_server()
blogdown::hugo_build()
setwd()
blogdown::build_site(build_rmd = T)
blogdown::serve_site()
blogdown::build_site(build_rmd = T)
blogdown::stop_server()
