---
title: ""
date: 2020-02-24
output:
  html_document:
    df_print: paged
    theme: cerulean
    highlight: zenburn
    fig_width: 8.5
    fig_height: 4
    code_folding: hide
---


```{r}
# All packages used below must be installed first


# devtools::install_github("laresbernardo/lares")
#library(lares)
library(ggplot2)

plot_timeline2 <- function(event, start, end = start + 1, label = NA, group = NA,
                           title = "Curriculum Vitae Timeline", subtitle = "Francisco Piccolo",
                           size = 9, colour = "orange", save = FALSE, subdir = NA) {
  df <- data.frame(
    Role = as.character(event), Place = as.character(label),
    Start = lubridate::date(start), End = lubridate::date(end),
    Type = group
  )
  cvlong <- data.frame(pos = rep(
    as.numeric(rownames(df)),
    2
  ), name = rep(as.character(df$Role), 2), type = rep(factor(df$Type,
    ordered = TRUE
  ), 2), where = rep(
    as.character(df$Place),
    2
  ), value = c(df$Start, df$End), label_pos = rep(df$Start +
    floor((df$End - df$Start) / 2), 2))
  maxdate <- max(df$End)
  p <- ggplot(cvlong, aes(
    x = value, y = reorder(name, -pos),
    label = where, group = pos
  )) + geom_vline(
    xintercept = maxdate,
    alpha = 0.8, linetype = "dotted"
  ) + labs(
    title = title,
    subtitle = subtitle, x = NULL, y = NULL, colour = NULL
  ) +
    theme(panel.background = element_rect(
      fill = "white",
      colour = NA
    ), axis.ticks = element_blank(), panel.grid.major.x = element_line(
      size = 0.55,
      colour = "grey70"
    ))
  if (!is.na(cvlong$type)[1] | length(unique(cvlong$type)) >
    1) {
    p <- p + geom_line(aes(color = type), size = size, alpha = .5) +
      facet_grid(type ~ ., scales = "free", space = "free") +
      guides(colour = FALSE) +
      scale_colour_hue()
  }
  else {
    p <- p + geom_line(size = size, colour = colour)
  }
  p <- p + geom_text(aes(x = label_pos),
    colour = "black",
    size = 2.8, alpha = 0.9
  )
  if (save) {
    file_name <- "cv_timeline.png"
    if (!is.na(subdir)) {
      dir.create(file.path(getwd(), subdir), recursive = T)
      file_name <- paste(subdir, file_name, sep = "/")
    }
    p <- p + ggsave(file_name, width = 8, height = 6, alpha = .2)
    message(paste("Saved plot as", file_name))
  }
  return(p)
}

order <- c("Role", "Place", "Type", "Start", "End")
today <- as.character(Sys.Date())


### Edit from here ###
cv <- data.frame(rbind(
  c("Graduação em Economia", "Puc Campinas", "Academic", "2015-01-01", "2018-12-31"),
  c("Técnico em Logistica", "Padre Anchieta", "Academic", "2011-01-01", "2012-12-31"),
  c("DW/Business Intelligence Analyst", "DAFITI", "Work Experience", "2019-01-01", today),
  c("Business Intelligence Analyst", "ID LOGISTICS", "Work Experience", "2017-01-01", "2018-12-01"),
  c("Jr Business Intelligence Analyst", "DAFITI", "Work Experience", "2015-02-01", "2016-12-31"),
  c("Jr Logistics Analyst", "ALL FRIG", "Work Experience", "2013-01-01", "2014-06-01"),
  c("Logistics Assistant", "ALL FRIG", "Work Experience", "2011-01-01", "2012-12-31"),
  c("Warehouse Operator", "ALL FRIG", "Work Experience", "2010-01-01", "2010-12-31"),
  c("Green Belt / Six Sigma", "EDTI", "Extra", "2015-01-01", "2015-02-28"),
  c("English", "Up Time", "Extra", "2012-01-01", "2012-12-31")
))
### Edit until here ###


colnames(cv) <- order
colour <- c("red", "blue", "green")

plot_timeline2(
  event = cv$Role,
  start = cv$Start,
  end = cv$End,
  label = cv$Place,
  group = cv$Type,
  save = FALSE,
  subtitle = "Francisco Piccolo" # replace with your name
)
```




