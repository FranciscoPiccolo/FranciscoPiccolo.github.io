

<p>Exploratory Data Analysis (EDA) is a technique developed by John Tukey in 1960 that aims the following goals: formulate hipothesis, generate graphs e understand patterns on the data. All these goals envision to make people aware of insights that they hadn’t thought before. With this technique being created, also became alive the program language S, the predecessor of R.</p>
<p>The EDA is an activity frequently made by many different professionals, that have to handle with increasingly data volumes (structured and unstructured) to answer business questions in a fastly pace. In this post I’ll use a dataset that I’ve got in a hiring process to perform an exploratory data analysis task. The goal will be the generation of insights from this dataset to make recommendations for the alleged directors of this company.</p>
<p>Before we start, lets call the necessary packages for this project.</p>
<pre class="r"><code># Pacotes para importar
library(tidyverse)
library(gridExtra)
library(grid)
library(zoo)
library(knitr)
library(scales)
library(ggthemes)
library(zoo)
library(readxl)
library(Amelia)

theme_set(theme_bw())

theme_graph &lt;- function(){
  theme(
    # background color
    panel.background = element_rect(fill = &quot;white&quot;),
    panel.grid.minor = element_blank(),
    plot.title = element_text(size = 16),
    plot.subtitle = element_text(size = 12),
    plot.caption = element_text(face = &quot;italic&quot;, size = 9),
    axis.text = element_text(size = 9),
    axis.title = element_text(face = &quot;italic&quot;, size = 9),
    text = element_text(family = &quot;Times New Roman&quot;),
    strip.background = element_rect(fill = &quot;grey&quot;),
    strip.text = element_text(face = &quot;bold&quot;),
    legend.title = element_blank(),
    legend.position = &quot;bottom&quot;
  )
}
  
graph_color &lt;- &quot;#006666&quot;</code></pre>
<p>The dataset is already on my Desktop, thus I’ll just import it to R Studio using “readxl” package.</p>
<pre class="r"><code>df &lt;- readxl::read_xls(&quot;C:/Users/francisco.piccolo/Desktop/R/02.Data_bases/Global Superstore.xls&quot;)</code></pre>
<p>Lets see the data structure using a sample of 10 rows of the dataset. For this, I’ll use the <strong>dim</strong> function that inform the dimension of my dataset in terms of rows and columns. The <strong>sample</strong> function will be used to generate the 10 samples from the dataset.</p>
<pre class="r"><code>dim(df)</code></pre>
<pre><code>## [1] 51290    24</code></pre>
<pre class="r"><code>df[sample(nrow(df),10), ]</code></pre>
<pre><code>## # A tibble: 10 x 24
##    `Row ID` `Order ID` `Order Date`        `Ship Date`         `Ship Mode`
##       &lt;dbl&gt; &lt;chr&gt;      &lt;dttm&gt;              &lt;dttm&gt;              &lt;chr&gt;      
##  1     9710 MX-2014-1~ 2014-09-27 00:00:00 2014-10-01 00:00:00 Standard C~
##  2     1419 US-2013-1~ 2013-01-07 00:00:00 2013-01-13 00:00:00 Standard C~
##  3    19456 ES-2012-4~ 2012-10-26 00:00:00 2012-10-26 00:00:00 Same Day   
##  4    16456 IT-2012-2~ 2012-08-29 00:00:00 2012-09-01 00:00:00 First Class
##  5    30604 IN-2014-8~ 2014-10-06 00:00:00 2014-10-11 00:00:00 Standard C~
##  6    16869 ES-2013-5~ 2013-08-07 00:00:00 2013-08-14 00:00:00 Standard C~
##  7     2270 MX-2013-1~ 2013-11-25 00:00:00 2013-11-30 00:00:00 Standard C~
##  8    28836 ID-2012-6~ 2012-07-18 00:00:00 2012-07-19 00:00:00 First Class
##  9    18481 ES-2011-4~ 2011-12-15 00:00:00 2011-12-20 00:00:00 Second Cla~
## 10     5025 MX-2014-1~ 2014-09-26 00:00:00 2014-10-03 00:00:00 Standard C~
## # ... with 19 more variables: `Customer ID` &lt;chr&gt;, `Customer Name` &lt;chr&gt;,
## #   Segment &lt;chr&gt;, City &lt;chr&gt;, State &lt;chr&gt;, Country &lt;chr&gt;, `Postal Code` &lt;chr&gt;,
## #   Market &lt;chr&gt;, Region &lt;chr&gt;, `Product ID` &lt;chr&gt;, Category &lt;chr&gt;,
## #   `Sub-Category` &lt;chr&gt;, `Product Name` &lt;chr&gt;, Sales &lt;dbl&gt;, Quantity &lt;dbl&gt;,
## #   Discount &lt;dbl&gt;, Profit &lt;dbl&gt;, `Shipping Cost` &lt;dbl&gt;, `Order Priority` &lt;chr&gt;</code></pre>
<p>Also, lets see if there are null values on this dataset through the <strong>Amelia</strong> package, that has the <strong>missmap</strong> function that shows in a graph the null values of the hole dataset.</p>
<pre class="r"><code>Amelia::missmap(df)</code></pre>
<p><img src="2020-03-10-exploratory-data-analysis-project_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>We can see that some fields are incorrectly named (i.e. with spaced separating compound names), thus I’ll adjust these fields to simplify future data manipulation.</p>
<pre class="r"><code>df_adj &lt;- df %&gt;% 
  transmute(
    order_date = `Order Date`,
    customer = `Customer ID`,
    segment = Segment,
    category = Category,
    sub_category = `Sub-Category`,
    city = City,
    ship_date = `Ship Date`,
    ship_mode = `Ship Mode`,
    product_id = `Product ID`,
    order_priority = `Order Priority`,
    product_name = `Product Name`,
    market = Market,
    region = Region,
    qty = Quantity,
    sales = Sales,
    profit = Profit,
    shipping_cost = `Shipping Cost`,
    discount = Discount
  )</code></pre>
<p>Now with the fields adjusted, we can start the EDA task, remembering that the goal will be generate recommendation for the supposed directors of this company. Before we start, it’s interesting to establish a reasoning line to approach the dataset. Another important point to have in mid is that if the analyst overly “torture” the data, it will confess anything even if it isn’t the truth. John Tukey mention this on his conferencies about exploratory data analysis and in his books, trying to explain that too many data manipulations can lead to incorrect conclusions if they’re incorrectly made.</p>
<p>The reasoning that I’ll follow to approach this task will be (i) visualize the financial data through time series plots in order to verify trendings and sazonality on financial indicators of the company; (ii) analyse market sales to identify areas to improve; (iii) analyse the product portfolio to see if there are products undermining the profit margin; (iv) analyse the operational aspect of the business to identify strategies that must change in order to recover profit margin.</p>
<p>In this dataset, there’re commercial informations, where the company sells for the whole world office products and technologic products. The dataset presents revenue, profit, discount and delivery cost, that I’ll call financial data. As well as this information, the dataset contain customer, product and operational data.</p>
<div id="time-series-of-financial-data" class="section level2">
<h2><strong>Time series of financial data</strong></h2>
<p>To begin, lets dive in on the financial indicators of the company. The following graph presents revenue throughout 2011-2015 period. As the revenue variation is too high I opted to smooth the line with a moving average of 30 days to ease de visualization.</p>
<pre class="r"><code>df_adj %&gt;% 
  mutate(year = as.numeric(substr(order_date,1,4))) %&gt;% 
  group_by(order_date) %&gt;% 
  summarise(sales = sum(sales)) %&gt;% 
  mutate(roll_avg_sales = zoo::rollmean(sales, 30, na.pad = T, align = &quot;right&quot;)) %&gt;% 
  ggplot()+
  geom_line(aes(x = order_date, y = roll_avg_sales, color = &quot;roll_avg_sales&quot;))+
  geom_line(aes(x = order_date, y = sales, color = &quot;sales&quot;), alpha = .1)+
  geom_smooth(aes(x = order_date, y = roll_avg_sales, color = &quot;trend&quot;), method = &quot;lm&quot;)+
  scale_y_continuous(labels = scales::comma)+ 
  scale_color_manual(values = c(&quot;sales&quot; = &quot;black&quot;,
                                &quot;roll_avg_sales&quot; = graph_color,
                                &quot;trend&quot; = &quot;red&quot;),
                     labs(color = &quot;&quot;))+
  theme_graph()+
  labs(title = &quot;Daily revenue time series&quot;,
       subtitle = &quot;Growth treding and sazonality&quot;,
       x = &quot;Sales Date&quot;,
       y = &quot;Revenue&quot;,
       caption = &quot;30 days moving average&quot;)</code></pre>
<p><img src="2020-03-10-exploratory-data-analysis-project_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>At the above graph, the sales present sazonality and also it shows that the company is expanding. Lets see on the next graph if the profit’s followed the same pattern.</p>
<pre class="r"><code>df_adj %&gt;% 
  mutate(year = as.numeric(substr(order_date,1,4))) %&gt;% 
  group_by(order_date) %&gt;% 
  summarise(sales = sum(sales),
            profit = sum(profit)) %&gt;% 
  mutate(roll_avg_profit = zoo::rollmean(profit, 30, na.pad = T, align = &quot;right&quot;)) %&gt;% 
  ggplot()+
  geom_line(aes(x = order_date, y = roll_avg_profit, color = &quot;roll_avg_profit&quot;))+
  geom_line(aes(x = order_date, y = profit, color = &quot;profit&quot;), alpha = .1)+
  geom_smooth(aes(x = order_date, y = roll_avg_profit, color = &quot;trend&quot;), method = &quot;lm&quot;)+
  scale_y_continuous(labels = scales::comma)+
  scale_color_manual(values = c(&quot;profit&quot; = &quot;black&quot;,
                                &quot;roll_avg_profit&quot; = graph_color,
                                &quot;trend&quot; = &quot;red&quot;),
                     labs(color = &quot;&quot;))+
  theme_graph()+
  labs(title = &quot;Daily profit time series&quot;,
       x = &quot;&quot;,
       y = &quot;&quot;,
       caption = &quot;30 days moving average&quot;)</code></pre>
<p><img src="2020-03-10-exploratory-data-analysis-project_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>The profit is following the same pattern of the sales, however the visualization has gotten a little bit distorced on behalf of net lost earned at some days. It’s seems prefered to normalize the profit by the revenue sold to get profit margin. Lets see this metric at the following graph.</p>
<pre class="r"><code>df_adj %&gt;%
  group_by(order_date) %&gt;% 
  summarise(sales = sum(sales),
            profit = sum(profit)) %&gt;% 
  mutate(roll_sum_sales = zoo::rollsum(sales, 30, na.pad = T, align = &quot;right&quot;),
         roll_sum_profit = zoo::rollsum(profit, 30, na.pad = T, align = &quot;right&quot;)) %&gt;% 
  mutate(profit_p = round(roll_sum_profit/roll_sum_sales,digits = 4),
         profit_mg = round(profit/sales, digits = 4)) %&gt;% 
  ggplot()+
  geom_line(aes(x = order_date, y = profit_p, color = &quot;roll_avg_profit&quot;))+
  #geom_line(aes(x = order_date, y = profit_mg, color = &quot;profit&quot;), alpha = .2)+
  scale_y_continuous(labels = scales::percent)+
  scale_color_manual(values = c(&quot;roll_avg_profit&quot; = graph_color,
                                &quot;profit&quot; = &quot;black&quot;),
                     labs(color = &quot;&quot;))+
  theme_graph()+
  labs(title = &quot;Profit margin time series&quot;,
       x = &quot;&quot;,
       y = &quot;&quot;,
       caption = &quot;30 days moving average&quot;)</code></pre>
<p><img src="2020-03-10-exploratory-data-analysis-project_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>Beyong profit, it’s important to see if delivery costs stayed stable during the period. In accordance with the following graph, apparently the company didn’t gain operational improvement event with the revenue growth.</p>
<pre class="r"><code>df_adj %&gt;%
  group_by(order_date) %&gt;% 
  summarise(sales = sum(sales),
            shipping_cost = sum(shipping_cost)) %&gt;% 
  mutate(roll_sum_sales = zoo::rollsum(sales, 30, na.pad = T, align = &quot;right&quot;),
         roll_sum_shipping_cost = zoo::rollsum(shipping_cost, 30, na.pad = T, align = &quot;right&quot;)) %&gt;% 
  mutate(shipping_cost = round(roll_sum_shipping_cost/roll_sum_sales,digits = 4)) %&gt;% 
  ggplot()+
  geom_line(aes(x = order_date, y = shipping_cost, group = 1), color = graph_color)+
  scale_y_continuous(labels = scales::percent)+
  theme_graph()+
  labs(title = &quot;Delivery cost time series&quot;,
       x = &quot;&quot;,
       y = &quot;&quot;,
       caption = &quot;30 days moving average&quot;)</code></pre>
<p><img src="2020-03-10-exploratory-data-analysis-project_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Finally, lets see how the discount strategy was implemented during the period. The following graph will show the average discount in proportion of the revenue.</p>
<pre class="r"><code>df_adj %&gt;%
  mutate(discount_amount = discount * sales) %&gt;% 
  group_by(order_date) %&gt;% 
  summarise(sales = sum(sales),
            shipping_cost = sum(shipping_cost),
            discount = sum(discount_amount)) %&gt;% 
  mutate(roll_sum_sales = zoo::rollsum(sales, 30, na.pad = T, align = &quot;right&quot;),
         roll_sum_shipping_cost = zoo::rollsum(shipping_cost, 30, na.pad = T, align = &quot;right&quot;),
         roll_sum_discount = zoo::rollsum(discount, 30, na.pad = T, align = &quot;right&quot;)) %&gt;%
  mutate(discount = round(roll_sum_discount/roll_sum_sales,digits = 4)) %&gt;% 
  ggplot()+
  geom_line(aes(x = order_date, y = discount, group = 1), color = graph_color)+
  scale_y_continuous(labels = scales::percent)+
  theme_graph()+
  labs(title = &quot;Discount margin time series&quot;,
       x = &quot;&quot;,
       y = &quot;&quot;,
       caption = &quot;30 days moving average&quot;)</code></pre>
<p><img src="2020-03-10-exploratory-data-analysis-project_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>After we get the time series of financial metrics, we can walk in on onther aspects of the business to generate some business recommendations.</p>
</div>
<div id="region" class="section level2">
<h2><strong>Region</strong></h2>
<p>On the following graphs, we’ll see the region that generates more profit for the company. Also, we’ll analyse if the delivery cost in relation to the revenue varies between regions.</p>
<pre class="r"><code>graph_1 &lt;- df_adj %&gt;% 
  filter(order_date &gt;= &quot;2014-01-01&quot;) %&gt;% 
  group_by(region) %&gt;% 
  summarise(sales = sum(sales),
            profit = sum(profit),
            shp_cost = sum(shipping_cost)) %&gt;% 
  ungroup() %&gt;% 
  mutate(region = fct_reorder(region, sales)) %&gt;% 
  ggplot()+
  geom_col(aes(x = region, y = sales), fill = graph_color)+
  scale_y_continuous(labels = scales::comma)+ 
  theme_graph()+
  coord_flip()+
  labs(y = &quot;Sales&quot;,
       x = &quot;&quot;)

graph_2 &lt;- df_adj %&gt;% 
  filter(order_date &gt;= &quot;2014-01-01&quot;) %&gt;% 
  group_by(region) %&gt;% 
  summarise(sales = sum(sales),
            profit = sum(profit),
            shp_cost = sum(shipping_cost)) %&gt;% 
  mutate(profit_mg = round(profit/sales, digits = 4)) %&gt;% 
  ungroup() %&gt;% 
  mutate(region = fct_reorder(region, sales)) %&gt;% 
  ggplot()+
  geom_col(aes(x = region, y = profit_mg), fill = graph_color)+
  scale_y_continuous(labels = scales::percent)+
  theme_graph()+
  coord_flip()+
  labs(y = &quot;Profit margin&quot;,
       x = &quot;&quot;,
       caption = &quot;&quot;)

graph_3 &lt;- df_adj %&gt;% 
  filter(order_date &gt;= &quot;2014-01-01&quot;) %&gt;% 
  group_by(region) %&gt;% 
  summarise(sales = sum(sales),
            profit = sum(profit),
            shp_cost = sum(shipping_cost)) %&gt;% 
  mutate(profit_mg = round(profit/sales, digits = 4),
         ship_cost_mg = round(shp_cost/sales, digits = 4)) %&gt;% 
  ungroup() %&gt;% 
  mutate(region = fct_reorder(region, sales)) %&gt;% 
  ggplot()+
  geom_col(aes(x = region, y = ship_cost_mg), fill = graph_color)+
  scale_y_continuous(labels = scales::percent)+
  theme_graph()+
  coord_flip()+
  labs(y = &quot;Delivery cost&quot;,
       x = &quot;&quot;,
       caption = &quot;Period: 2014 e 2015&quot;)

graph_4 &lt;- df_adj %&gt;% 
  mutate(discount_amount = discount * sales) %&gt;% 
  filter(order_date &gt;= &quot;2014-01-01&quot;) %&gt;% 
  group_by(region) %&gt;% 
  summarise(sales = sum(sales),
            profit = sum(profit),
            shp_cost = sum(shipping_cost),
            discount = sum(discount_amount)) %&gt;% 
  mutate(profit_mg = round(profit/sales, digits = 4),
         ship_cost_mg = round(shp_cost/sales, digits = 4),
         discount_mg = round(discount/sales, digits = 4)) %&gt;% 
  ungroup() %&gt;% 
  mutate(region = fct_reorder(region, sales)) %&gt;% 
  ggplot()+
  geom_col(aes(x = region, y = discount_mg), fill = graph_color)+
  scale_y_continuous(labels = scales::percent)+
  theme_graph()+
  coord_flip()+
  labs(y = &quot;Discount margin&quot;,
       x = &quot;&quot;,
       caption = &quot;Period: 2014 e 2015&quot;)

gridExtra::grid.arrange(graph_1,graph_2, graph_3,graph_4, ncol = 2, nrow = 2, top = textGrob(&quot;Revenue, Profit, Delivery cost and discount per region&quot;))</code></pre>
<p><img src="2020-03-10-exploratory-data-analysis-project_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>Apparently, Canada is the region to receive more attention, since it has a profit margin higher than the average, maybe it’s because the discount policy is different atthere. On the other hand, South East Asia needs some strategy change in order to reach the other countries in profit margins. The delivery cost is the same between reagions.</p>
</div>
<div id="product-category-and-sub-category" class="section level2">
<h2><strong>Product Category and Sub-category</strong></h2>
<p>The company works with three product categories: Technologic, Furniture and Office supplies. In the next visualization, we’ll see which category has gained traction along the period as well as the profit margin of each of them</p>
<pre class="r"><code>df_adj %&gt;%
  group_by(category, order_date) %&gt;% 
  summarise(sales = sum(sales)) %&gt;% 
  ggplot()+
  geom_smooth(aes(x = order_date, y = sales, group = category, color = category), se = F)+
  scale_y_continuous(labels = scales::comma)+ 
  theme_graph()+
  labs(title = &quot;Category sales time series&quot;,
       x = &quot;&quot;,
       y = &quot;&quot;)</code></pre>
<p><img src="2020-03-10-exploratory-data-analysis-project_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>Apparently three categories present similar behavior during the period, having the technologic category as the most sold. Following we’ll see which one have bring the highest profit margin.</p>
<pre class="r"><code>df_adj %&gt;%
  filter(order_date &gt;= &quot;2014-01-01&quot;) %&gt;% 
  group_by(category) %&gt;% 
  summarise(sales = sum(sales),
            profit = sum(profit),
            shp_cost = sum(shipping_cost)) %&gt;% 
  mutate(profit_mg = round(profit/sales, digits = 4)) %&gt;% 
  ggplot()+
  geom_col(aes(x = category, y = profit_mg), fill = graph_color)+
  scale_y_continuous(labels = scales::percent)+ 
  theme_graph()+
  labs(title = &quot;Category profit margin&quot;,
       x = &quot;&quot;,
       y = &quot;&quot;,
       caption = &quot;Period: 2014 e 2015&quot;)</code></pre>
<p><img src="2020-03-10-exploratory-data-analysis-project_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>The technologic products presents the highest profit margin, thus the company is on the right track in its comercial strategy. Now lets analyse the product categories with focus on discount and delivery cost.</p>
<pre class="r"><code>df_adj %&gt;% 
  mutate(discount = discount * sales) %&gt;% 
  filter(order_date &gt;= &quot;2014-01-01&quot;) %&gt;% 
  group_by(category) %&gt;% 
  summarise(sales = sum(sales),
            discount = sum(discount),
            shipping_cost = sum(shipping_cost)) %&gt;% 
  mutate(discount_mg = round(discount/sales, digits = 4),
         shipping_cost_mg = round(shipping_cost/sales, digits = 4)) %&gt;% 
  select(category, discount_mg, shipping_cost_mg) %&gt;% 
  tidyr::gather(&quot;campo&quot;,&quot;valor&quot;,2:3) %&gt;% 
  ggplot(aes(x = category, y = valor, fill = campo))+
  geom_col(position = &quot;dodge&quot;,alpha = .6)+
  scale_fill_manual(values = c(&quot;discount_mg&quot; = graph_color,
                               &quot;shipping_cost_mg&quot; = &quot;blue&quot;),
                    labs(color = &quot;&quot;))+
  scale_y_continuous(labels = scales::percent)+
  theme_graph()+
  labs(title = &quot;Discount and delivery cost by category&quot;,
       x = &quot;&quot;,
       y = &quot;&quot;)</code></pre>
<p><img src="2020-03-10-exploratory-data-analysis-project_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>The graph above indicates that the discount applied for the “Technology” category is lower and the delivery cost is stable for all three categories. Finishing the focus on product category, we can see that there isn’t an urgent recommendation to be made for the company’s directors. Lets dive in on the sub-category part of the analyse.</p>
<pre class="r"><code>df_adj %&gt;%
  filter(order_date &gt;= &quot;2014-01-01&quot;) %&gt;% 
  group_by(sub_category) %&gt;% 
  summarise(sales = sum(sales),
            profit = sum(profit),
            shp_cost = sum(shipping_cost)) %&gt;% 
  mutate(profit_mg = round(profit/sales, digits = 4)) %&gt;% 
  ungroup() %&gt;% 
  mutate(sub_category = fct_reorder(sub_category, profit_mg)) %&gt;% 
  ggplot()+
  geom_col(aes(x = sub_category, y = profit_mg), fill = graph_color)+
  scale_y_continuous(labels = scales::percent)+ 
  theme_graph()+
  labs(title = &quot;Profit margin by product category&quot;,
       x = &quot;&quot;,
       y = &quot;&quot;,
       caption = &quot;Period: 2014 e 2015&quot;)+
  coord_flip()</code></pre>
<p><img src="2020-03-10-exploratory-data-analysis-project_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>Its possible to note that “Tablets” is very prejudicial for the company. Maybe the discount applied for this sub-category is undermining the market rentability. The following graph presents the discount applied for each sub-category.</p>
<pre class="r"><code>df_adj %&gt;%
  mutate(discount = discount * sales) %&gt;% 
  filter(order_date &gt;= &quot;2014-01-01&quot;) %&gt;% 
  group_by(sub_category) %&gt;% 
  summarise(sales = sum(sales),
            profit = sum(profit),
            shp_cost = sum(shipping_cost),
            discount = sum(discount)) %&gt;% 
  mutate(discount_mg = round(discount/sales, digits = 4)) %&gt;% 
  ungroup() %&gt;% 
  mutate(sub_category = fct_reorder(sub_category, discount_mg)) %&gt;% 
  ggplot()+
  geom_col(aes(x = sub_category, y = discount_mg), fill = graph_color)+
  scale_y_continuous(labels = scales::percent)+ 
  theme_graph()+
  labs(title = &quot;Average discount margin by product category&quot;,
       x = &quot;&quot;,
       y = &quot;&quot;,
       caption = &quot;Period: 2014 e 2015&quot;)+
  coord_flip()</code></pre>
<p><img src="2020-03-10-exploratory-data-analysis-project_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>Clearly the discount policy for “Tablets” will need a revision. This sub-category has 366 different products, lets see which one are receiving the highest discount, the profit margin and the revenue sold. The following graph show this view.</p>
<pre class="r"><code>df_adj %&gt;% 
  mutate(discount = discount * sales) %&gt;% 
  filter(sub_category == &quot;Tables&quot;) %&gt;% 
  select(sub_category, sales, product_id, discount, profit) %&gt;% 
  group_by(product_id) %&gt;% 
  summarise(sales = sum(sales),
            profit = sum(profit),
            discount = sum(discount)) %&gt;% 
  mutate(profit_mg = round(profit/sales, digits = 4),
         discount_mg = round(discount/sales, digits = 4),
         Product_demand = ifelse(sales &gt;= 3000, &quot;high_demand&quot;,&quot;low_demand&quot;)) %&gt;% 
  filter(profit_mg &gt;= -2) %&gt;% 
  ggplot()+
  geom_point(aes(x = profit_mg, y = discount_mg, size = sales, color = Product_demand), shape = 20, alpha = .6)+
  geom_vline(xintercept = 0, lty = 2, color = &quot;red&quot;)+
  scale_x_continuous(labels = scales::percent)+
  scale_y_continuous(labels = scales::percent)+
  scale_color_manual(values = c(&quot;high_demand&quot; = &quot;black&quot;,
                                &quot;low_demand&quot; = &quot;dark orange&quot;))+
  theme_graph()+
  labs(title = &quot;Product profit and discount margin relation&quot;,
       x = &quot;Profit margin&quot;,
       y = &quot;Discount&quot;)</code></pre>
<p><img src="2020-03-10-exploratory-data-analysis-project_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>A lot of products selling a relevant quantity (above 3.000 unities on the considered period) and with a high discount portion making the sales prejudicial for the company. It’s necessary to verify if this also occurs with other sub-categories.</p>
<pre class="r"><code>df_adj %&gt;% 
  mutate(discount = discount * sales) %&gt;% 
  select(sub_category, sales, product_id, discount, profit) %&gt;% 
  group_by(product_id, sub_category) %&gt;% 
  summarise(sales = sum(sales),
            profit = sum(profit),
            discount = sum(discount)) %&gt;% 
  mutate(profit_mg = round(profit/sales, digits = 4),
         discount_mg = round(discount/sales, digits = 4),
         Product_demand = ifelse(sales &gt;= 3000, &quot;high_demand&quot;,&quot;low_demand&quot;)) %&gt;% 
  ungroup() %&gt;% 
  mutate(sub_category = fct_relevel(sub_category, levels = c(&quot;Tables&quot;,&quot;Machines&quot;,&quot;Chairs&quot;,&quot;Supplies&quot;,&quot;Storage&quot;,&quot;Furnishings&quot;,&quot;Bookcases&quot;,&quot;Phones&quot;,&quot;Fasteners&quot;,&quot;Binders&quot;,&quot;Appliances&quot;,&quot;Envelopes&quot;,&quot;Art&quot;,&quot;Accessories&quot;,&quot;Copiers&quot;,&quot;Labels&quot;,&quot;Paper&quot;))) %&gt;% 
  filter(profit_mg &gt;= -2) %&gt;% 
  ggplot()+
  geom_point(aes(x = profit_mg, y = discount_mg, size = sales, color = Product_demand), shape = 20, alpha = .5)+
  geom_vline(xintercept = 0, lty = 2, color = &quot;red&quot;)+
  scale_x_continuous(labels = scales::percent)+
  scale_y_continuous(labels = scales::percent)+
  scale_color_manual(values = c(&quot;high_demand&quot; = &quot;black&quot;,
                                &quot;low_demand&quot; = &quot;dark orange&quot;))+
  theme_graph()+
  facet_wrap(~sub_category)</code></pre>
<p><img src="2020-03-10-exploratory-data-analysis-project_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>Seems that products from other sub-categories don’t have the same aggressive discount policy. Thus, the sub-category “Tablets” and “Machines” present a lot of black points at the left part of the graph (separeted by the red line). We can conclude that the company’s directors will need some adjustments on this discount policy.</p>
</div>
<div id="operations" class="section level2">
<h2><strong>Operations</strong></h2>
<p>In this topic we’ll analyse the financial metrics by the operational perspective, aiming to analyse if the order criticality and the delivery contract cause some financial impact.</p>
<pre class="r"><code>df_adj %&gt;% 
  filter(order_date &gt;= &quot;2014-01-01&quot;) %&gt;% 
  group_by(order_priority, ship_mode) %&gt;% 
  summarise(sales = sum(sales),
            profit = sum(profit),
            shipping_cost = sum(shipping_cost)) %&gt;% 
  ungroup() %&gt;% 
  mutate(order_priority = fct_relevel(order_priority, levels = c(&quot;Low&quot;,&quot;Medium&quot;,&quot;High&quot;,&quot;Critical&quot;))) %&gt;% 
  ggplot(aes(x = order_priority, y = sales, fill = ship_mode))+
  geom_col(alpha = .7)+
  scale_y_continuous(labels = scales::comma)+
  scale_fill_brewer(type = &quot;qual&quot;)+
  theme_graph()+
  labs(title = &quot;Sales by order priority and delivery contract&quot;,
       x = &quot;&quot;,
       y = &quot;&quot;)</code></pre>
<p><img src="2020-03-10-exploratory-data-analysis-project_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<pre class="r"><code>df_adj %&gt;%
  filter(order_date &gt;= &quot;2014-01-01&quot;,
         sub_category != &quot;Tables&quot;) %&gt;% 
  mutate(profit_mg = round(profit/sales, digits = 4)) %&gt;%
  mutate(order_priority = fct_relevel(order_priority, levels = c(&quot;Low&quot;,&quot;Medium&quot;,&quot;High&quot;,&quot;Critical&quot;)),
         ship_mode = fct_relevel(ship_mode, levels = c(&quot;Standard Class&quot;,&quot;Second Class&quot;,&quot;First Class&quot;,&quot;Same Day&quot;))) %&gt;% 
  ggplot(aes(x = profit_mg))+
  geom_histogram(alpha = .6, binwidth = .1, fill = graph_color)+
  geom_vline(xintercept = 0, lty = 2, color = &quot;red&quot;)+
  scale_x_continuous(labels = scales::percent)+
  theme_graph()+
  labs(title = &quot;Operational scenarios and profit margin&quot;,
       x = &quot;&quot;,
       y = &quot;&quot;)+
  facet_grid(order_priority~ship_mode, scales = &quot;free&quot;)</code></pre>
<p><img src="2020-03-10-exploratory-data-analysis-project_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>Apparently the operational scenario isn’t a culprit of profit margin. Orders with low priority are shipped within the “Standard Class” delivery contract (and it’s correct). On the other hand, orders with the highest priority aren’t sent by the “Standard Class” delivery contract. Finally, we conclude for this topic that the operational perspective can’t explain much of the profit margin variation, neither generate some recommendation for the company’s directors.</p>
</div>
<div id="conclusions-and-recommendations" class="section level2">
<h2><strong>Conclusions and recommendations</strong></h2>
<p>Considering the business aspects being analysed I come with some recommendations. First, the company has to verify its discount policy, urgently for its “Tablets” sub-category, since a lot of sales turns out to be prejudicial given the discount allowed. Second, it’s important to pay more attention for the Canadian operations, because it’s a prosperous market for the company. Third, the South East Asian market will need some attention in order to catch up with other regions on profit margin.</p>
</div>
