---
title: "Econometria - Atividade"
author: "Francisco Piccolo"
date: "2020-12-08"
output:
    prettydoc::html_pretty:
      theme: leonids
      fig_height: 4
      fig_width: 6
      df_print: paged
---


```{r, eval = T, echo = T, warning = F, error = F, message=F}
# install.packages("tidyverse") >> Para instalar o pacote caso n?o o tenha instalado
library(tidyverse)  # Para chamar o pacote
library(GGally)
library(datarium)
```

## **Dataset**

Dados de investimento em marketing nas ferramentas **Youtbube**, **Facebook** e **Newspaper** e impacto nas vendas (**sales**).

```{r, eval=T, warning=F, error=F, message=F}
datarium::marketing %>% 
  head(10) %>% 
  as.tibble()

dataset <- datarium::marketing
```

## **Modelo**

Regress?o Linear M?ltipla do seguinte formato:

$$\hat{Sales} = \hat{\beta_1}X_1 + \hat{\beta_2}X_2 + \hat{\beta_3}X_3 + \mu$$

### **Executando o modelo**

```{r, eval=T, warning=F, error=F, message=F}
# Salvando o modelo na vari?vel 'regression_model'
dataset %>% 
  lm(formula = sales ~ youtube + facebook + newspaper) -> regression_model
```

### **Validando o resultado**

```{r, eval=T, warning=F, error=F, message=F}
regression_model %>% 
  summary() %>% 
  pander::pander()
```

Adicionando os valores estimados e res?duos ao dataset original para compara??o.

```{r, eval=T, warning=F, error=F, message=F}
dataset$fitted <- regression_model$fitted.values
dataset$residuals <- regression_model$residuals
```

Plotando os resultados para verificar a performance

```{r, eval=T, warning=F, error=F, message=F, fig.align="center"}
dataset %>% 
  mutate(rows = seq(1, 200, by = 1)) %>% 
  ggplot2::ggplot()+
  geom_line(mapping = aes(x = rows, y = sales, color = "Actual sales"))+
  geom_line(mapping = aes(x = rows, y = fitted, color = "Predicted sales"))+
  scale_color_manual(values = c("Actual sales" = "steel blue",
                                "Predicted sales" = "dark orange"),
                     name = "")+
  theme(legend.position = "bottom")+
  labs(title = "Valida??o dos valores atuais e projetados",
       x = "",
       y = "")
```

```{r, eval=T, warning=F, error=F, message=F, fig.align="center"}
dataset %>% 
  ggplot2::ggplot()+
  geom_histogram(mapping = aes(x = residuals))+
  labs(title = "Distribuição dos resíduos",
       y = "")
```

Verificando se há autocorrelção entre as variáveis explicativas

```{r, eval=T, warning=F, error=F, message=F, fig.align="center"}
datarium::marketing %>% 
  GGally::ggpairs()
```


